:: Widgets Mirror [widget]
<<widget "mirror">>
	<div id="mirror">
		<<if _args[0] isnot undefined>>
			<<mirrorDisplay _args[0]>>
		<<else>>
			<<mirrorDisplay>>
		<</if>>
	</div>
<</widget>>

<<widget "preMirror">>
	<<if (Browser.isMobile).any()>>
		<<set $showMannequins to 0>>
	<<else>>
		<<set $showMannequins to 1>>
	<</if>>
<</widget>>

<<widget "postMirror">>
	<<shopClothingFilterReset>> /* Due to the reusing of shop code */
<</widget>>

<<widget "mirrorDisplay">>
	<<switch $mirrorMenu>>
		<<case "appearance">>
			<<if playerBellyVisible(true) and !playerAwareTheyArePregnant()>>
				<<mirrorAppearancePregnancy>>
			<<else>>
				<<mirrorAppearance>>
			<</if>>
		<<case "body">>
			<<visual-settings>>
		<<case "skin">>
			<<mirrorSkin>>
		<<case "hair">>
			<<mirrorHair>>
		<<case "makeup">>
			<<mirrorMakeup>>
		<<case "transformation">>
			<<mirrorTransformation>>
		<<default>>
			<<mirrorMenu _args[0]>>
	<</switch>>
	<<calchairlengthstage>>
	<br><br>
<</widget>>

<<widget "mirrorwet">>
	<<if _args[1] or _args[2] or _args[3]>>
		<br>
		<<set $_part to _args[0]>>
		<<set $_semen to _args[1]>>
		<<set $_slime to _args[2]>>
		<<set $_nectar to _args[3]>>
		당신의
		<<if $_part is "허벅지" or $_part is "엉덩이" or $_part is "배" >>
			<<= $_part >>는
		<<else>>
			<<= $_part >>은
		<</if>>
		<<if $_semen gt 0>>
			<<switch Math.clamp($_semen, 1, 5)>>
				<<case 1>> <span class="blue">정액으로 축축해져</span>
				<<case 2>> <span class="purple">정액으로 적셔져</span>
				<<case 3>> <span class="purple">정액으로 미끄러워져</span>
				<<case 4>> <span class="pink">정액으로 젖어</span>
				<<case 5>> <span class="red">정액으로 흠뻑 젖어</span>
			<</switch>>
			<<if $_slime gt 0 and $_nectar gt 0>>
				있고,
			<<elseif $_slime gt 0 or $_nectar gt 0>>
				있고
			<<else>>
				있다.
			<</if>>
		<</if>>
		<<if $_slime gt 0>>
			<<switch Math.clamp($_slime, 1, 5)>>
				<<case 1>> <span class="blue">점액으로 축축해져</span>
				<<case 2>> <span class="purple">점액으로 적셔져</span>
				<<case 3>> <span class="purple">점액으로 미끄러워져</span>
				<<case 4>> <span class="pink">점액으로 젖어</span>
				<<case 5>> <span class="red">점액으로 흠뻑 젖어</span>
			<</switch>>
			<<if $_nectar gt 0>>
				있고
			<<else>>
				있다.
			<</if>>
		<</if>>
		<<if $_nectar gt 0>>
			<<switch Math.clamp($_nectar, 1, 5)>>
				<<case 1>> <span class="blue">꿀로 축축해져</span>
				<<case 2>> <span class="purple">꿀로 적셔져</span>
				<<case 3>> <span class="purple">꿀로 미끄러워져</span>
				<<case 4>> <span class="pink">꿀로 젖어</span>
				<<case 5>> <span class="red">꿀로 흠뻑 젖어</span>
			<</switch>>
			있다.
		<</if>>
	<</if>>
<</widget>>

<<widget "mirrorMenu">>
	<<set $_mirror to _args[0] || 'mirror'>>
	당신은 거울을 들여다본다.
	<<if $fallenangel is 2>>
		사람 같지도 않은 모습의 인물이
	<<elseif $hallucinogen gte 200>>
		거울이 새까만 검은 웅덩이로 녹아내리더니, 당신의 앞에 둥둥 떠있다.
		<<if $_mirror is 'mirror'>>
			유리 파편이 당신의 살갗을 스치고 지나가더니 허공 속으로 녹아든다.
		<</if>>
		<br>
		당신은 공허 속을 바라보고, 공허 또한
	<<elseif $hallucinogen gte 100>>
		이해할 수 없는 각도로 그 표면이 일그러지기 시작하더니, 무언가 알아볼 수 없는 것이
	<<elseif $hallucinogen gt 0>>
		그 앞에 서자 표면에 파문이 일더니, 어렴풋이 익숙한 소녀가
	<<elseif $trauma gte $traumamax>>
		멍한 눈의 소녀가
	<<else>>
		<<= $pain gte 100 ? "울고 있는" : $pain gte 40 ? "눈물이 그렁그렁한" : $pain gte 1 ? "얼굴을 찌푸린" : "활발한">> 소녀가
	<</if>>
	이쪽을 바라보고 있다.
	<<if ["haunt", "despair"].includes($wraith.state) and $hallucinations gte 1 and ((random(1, 100) is 1) or ($controlled is 0 and random(1, 100) lte 5))>>
		<span class="fading">창백한 형체가 당신 뒤에 서 있다.</span>
	<</if>>
	<br><br>
	<<crimeicon "mark">><<link "다른 사람들이 당신을 어떻게 바라보는지 확인한다">><<set $mirrorMenu to "appearance">><<replace #mirror>><<mirrorDisplay>><</replace>><<numberify "#passages > .passage">><</link>>
	<br><br>
	<<if !$simpleMirror>>
		__피부__
		<br>
		<<investigateicon>><<link "피부를 확인한다">><<set $mirrorMenu to "skin">><<replace #mirror>><<mirrorDisplay>><</replace>><<numberify "#passages > .passage">><</link>>
		<br><br>
	<</if>>
	__머리__
	<br>
	<<hairdressericon "hairspray">><<link "머리 스타일을 바꾼다">><<set $mirrorMenu to "hair">><<replace #mirror>><<mirrorDisplay>><</replace>><<numberify "#passages > .passage">><</link>>
	<br><br>
	__화장__
	<br>
	<<cosmeticsicon>><<link "화장을 한다">><<set $mirrorMenu to "makeup">><<replace #mirror>><<mirrorDisplay>><</replace>><<numberify "#passages > .passage">><</link>>
	<br><br>

	<<if $worn.neck.name is "love locket">>
		__로켓__
		<br>
		<span @class="'clothes-'+$worn.neck.colour.replace(' ','-')"><<icon "locket.png">></span><<link [[로켓의 사진을 바꾼다|Mirror Locket]]>><<set $passage_mirror to $passage>><</link>>
		<br><br>
	<</if>>

	<<if !$simpleMirror>>
		<<if $specialTransform is 1 or $physicalTransform is 1>>
			__변형__
			<br>
			<<if $demon gte 6>><<tficon "demon">>
			<<elseif $wolfgirl gte 6>><<tficon "wolf">>
			<<elseif $angel gte 6>><<tficon "angel">>
			<<elseif $fallenangel gte 2>><<tficon "fallenangel">>
			<<elseif $cat gte 6>><<tficon "cat">>
			<<elseif $cow gte 6>><<tficon "cow">>
			<<elseif $harpy gte 6>><<tficon "bird">>
			<<elseif $fox gte 6>><<tficon "fox">>
			<<else>><<tficon "angel">>
			<</if>>
			<<link "내적 자아를 살펴본다">><<set $mirrorMenu to "transformation">><<replace #mirror>><<mirrorDisplay>><</replace>><<numberify "#passages > .passage">><</link>>
		<<else>>
			이 이상 살펴보려면 이세계의 힘을 획득해야 한다.
		<</if>>
	<</if>>
	<br><br>
<</widget>>

<<widget "mirrorGender">>
	<div class="settingsGrid">
		<div class="settingsHeader">외모 특성</div>
		<<settextcolorfromfemininity $player.femininity>>
		<div class="settingsToggleItem">
			당신은 <span @class="_text_color"><<if playerBellyVisible(true)>>임신한 <</if>>소녀처럼 보인다.</span>
		</div>
		<div class="settingsToggleItem">
			<span class="gold bold">성별:</span>
			<br>
			<label class="blue">남자 <<radiobutton "$player.gender" "m" autocheck>></label> |
			<label class="pink">여자 <<radiobutton "$player.gender" "f" autocheck>></label> |
			<label class="purple">둘 다 아님 <<radiobutton "$player.gender" "n" autocheck>></label>
			<br>
			<span class="small-description">당신이 자신을 어떻게 인식하는지에 대한 것입니다. 당신의 성기나 그로 인한 타인의 반응을 바꾸지 않습니다.</span>
		</div>
		<div class="settingsToggleItem">
			<span class="gold bold">아래의 요인들이 그런 인상에 기여하고 있다:</span>
			<br>
			<<for _x range $player.gender_appearance_factors>>
				<<if _x.femininity is 0 or !_x.factor>>
					<<continue>>
				<</if>>
				<<settextcolorfromfemininity _x.femininity>>
				<span @class="_text_color">
					_x.factor
					<<if $debug is 1>>
						_x.femininity
					<<else>>
						<<print "+".repeat(
							Math.trunc(Math.clamp(
								Math.abs(_x.femininity) / 100, 0, 10
							))
						)>>
					<</if>>
				</span>
				<br>
			<</for>>
			<<if $debug is 1>>
				<<settextcolorfromfemininity $player.femininity>>
				여성성 수치 총계: <span @class="_text_color">$player.femininity</span>
				<br>
			<</if>>
		</div>
		<div class="settingsToggleItem">
			<span class="gold bold">태도:</span>
			<br>
			<<if $player.gender_posture is "자">>
				당신은 한 바퀴 돌며 자신의 모습을 살펴본다. 당신은 소녀처럼 보인다. 다른 방식으로 행동한다면 그 인상을 바꿀 수 있을지도 모른다.
			<<elseif $player.gender_posture is "여">>
				당신은 여자들이 할 법한 자세를 몇 개 취해보고는 최대한 여성스러운 목소리를 내본다.
				<br>
				<span class="pink">다른 사람들은 당신이 소녀라고 생각할 것이다.</span>
			<<elseif $player.gender_posture is "남">>
				당신은 근육에 힘을 주고 목소리를 조금 걸걸하게 만들어본다.
				<br>
				<span class="lblue">다른 사람들은 당신이 소년이라고 생각할 것이다.</span>
			<</if>>
			<br><br>
			<<set _postures to ["남성적임", "여성적임", "자연스러움"]>>
			자세:
			<<capture _i>>
				<<for _i = 0; _i < _postures.length; _i++>>
					<span @class="$player.gender_posture is _postures[_i].charAt(0) ? 'goldLink no-numberify' : 'unselected no-numberify'">
						<<link _postures[_i].toUpperFirst()>>
							<<set $player.gender_posture to _postures[_i].charAt(0)>>
							<<exposedcheck>>
							<<replace "#mirrorGender">><<mirrorGender>><</replace>>
						<</link>>
					</span>	<<= _i lt _postures.length - 1 ? "|" : "">>
				<</for>>
			<</capture>>
		</div>
	</div>
<</widget>>

<<widget "mirrorAppearance">>
	<<mirroricon>><<link "뒤로">><<replace #mirror>><<mirrorMenu>><</replace>><<numberify "#passages > .passage">><<unset $mirrorMenu>><</link>>
	<br><br>
	<span id="mirrorGender">
		<<mirrorGender>>
	</span>
	<hr>

	<div class="settingsGrid">
		<<set _increaseAllure to []>>
		<<set _increaseAttractive to []>>
		<<set _increaseBoth to (name) => {
			_increaseAllure.push(name);
			_increaseAttractive.push(name);
		}>>
		<<if $beauty gte ($beautymax / 7) * 6>>
			<<run _increaseBoth("미모: 성스러움 +++++")>>
		<<elseif $beauty gte ($beautymax / 7) * 5>>
			<<run _increaseBoth("미모: 매혹적임 ++++")>>
		<<elseif $beauty gte ($beautymax / 7) * 4>>
			<<run _increaseBoth("미모: 아름다움 +++")>>
		<<elseif $beauty gte ($beautymax / 7) * 3>>
			<<run _increaseBoth("미모: 매력적임 ++")>>
		<<elseif $beauty gte ($beautymax / 7) * 2>>
			<<run _increaseBoth("미모: 예쁨 +")>>
		<<elseif $beauty gte ($beautymax / 7)>>
			<<run _increaseBoth("미모: 귀여움")>>
		<</if>>
		<<run _increaseBoth(`머리 길이 ${$hairlength gte 333 ? "+".repeat($hairlength gte 666 ? 2 : 1) : ""}`)>>
		<<if $worn.upper.type.includes("naked")>>
			<<run _increaseBoth("상의를 입지 않음")>>
		<<elseif $worn.upper.reveal gte 500>>
			<<run _increaseBoth("몸매가 드러나는 상의")>>
		<</if>>
		<<if $worn.lower.type.includes("naked")>>
			<<run _increaseBoth("하의를 입지 않음")>>
		<<elseif $worn.lower.reveal gte 500>>
			<<run _increaseBoth("몸매가 드러나는 하의")>>
		<</if>>
		<<if $worn.under_lower.type.includes("naked")>>
			<<run _increaseBoth("팬티를 입지 않음")>>
		<<elseif $worn.under_lower.reveal gte 500>>
			<<run _increaseBoth("섹시한 속옷")>>
		<</if>>
		<<if $wolfgirl gte 6>>
			<<run _increaseBoth(`늑대 ${"+".repeat(2 - ["ears", "tail"].filter(p => $transformationParts.wolf[p] is "hidden").length)}`)>>
		<</if>>
		<<if $cat gte 6>>
			<<run _increaseBoth(`고양이 ${"+".repeat(2 - ["ears", "tail"].filter(p => $transformationParts.cat[p] is "hidden").length)}`)>>
		<</if>>
		<<if $cow gte 6>>
			<<run _increaseBoth(`소 ${"+".repeat(2 - Math.ceil(["ears", "tail", "horns"].filter(p => $transformationParts.cow[p] is "hidden").length / 2))}`)>>
		<</if>>
		<<if $harpy gte 6>>
			<<run _increaseBoth(`하피 ${"+".repeat(2 - Math.ceil(["tail", "eyes", "malar", "plumage", "wings"].filter(p => $transformationParts.bird[p] is "hidden").length / 3))}`)>>
		<</if>>
		<<if $fox gte 6>>
			<<run _increaseAttractive.push(`여우 ${"+".repeat(3 - ["ears", "tail"].filter(p => $transformationParts.fox[p] is "hidden").length)}`)>>
			<<run _increaseAllure.push(`여우 ${"+".repeat(3 - ["ears", "tail"].filter(p => $transformationParts.fox[p] is "hidden").length)}`)>>
		<</if>>
		<<if $angel gte 6>>
			<<run _increaseBoth(`천사 ${"+".repeat(2 - ["halo", "wings"].filter(p => $transformationParts.angel[p] is "hidden").length)}`)>>
		<</if>>
		<<if $fallenangel gte 2>>
			<<run _increaseBoth(`타천사 ${"+".repeat(2 - ["halo", "wings"].filter(p => $transformationParts.fallenAngel[p] is "hidden").length)}`)>>
		<</if>>
		<<if $demon gte 6>>
			<<run _increaseBoth(`악마 ${"+".repeat(2 - Math.ceil(["horns", "tail", "wings"].filter(p => $transformationParts.demon[p] is "hidden").length / 2))}`)>>
		<</if>>
		<<if $earSlime.growth gt 50>>
			<<run _increaseAllure.push(`귀 슬라임 페로몬${$earSlime.growth gt 75 ? " " + "+".repeat(Math.ceil(($earSlime.growth - 75) / 25)): ""}`)>>
		<</if>>
		<<if $makeup.lipstick != 0 or $makeup.eyeshadow != 0 or $makeup.mascara != 0 or $makeup.blusher != 0>>
			<<run _increaseAllure.push("매혹적인 화장")>>
			<<run _increaseAttractive.push("매력적인 화장")>>
		<</if>>
		<<if $worn.upper.reveal + $worn.lower.reveal gte 50>>
			<<set $_outfit to $worn.lower.name is "naked" or ($worn.upper.name is "naked" and $player.perceived_breastsize gt 2) ? '"옷차림"' : '옷차림'>>
			<<run _increaseAllure.push(`매혹적인 ${$_outfit} ${"+".repeat(Math.floor(($worn.upper.reveal + $worn.lower.reveal) / 400))}`)>>
			<<run _increaseAttractive.push(`멋진 ${$_outfit} ${"+".repeat(Math.floor(($worn.upper.reveal + $worn.lower.reveal) / 400))}`)>>
		<</if>>
		<<if $worn.head.reveal gte 50>>
			<<run _increaseAllure.push(`매혹적인 모자 ${"+".repeat(Math.floor($worn.head.reveal / 200))}`)>>
			<<run _increaseAttractive.push(`멋진 모자 ${"+".repeat(Math.floor($worn.head.reveal / 200))}`)>>
		<</if>>
		<<if $worn.face.reveal gte 50>>
			<<run _increaseAllure.push(`매혹적인 얼굴 악세사리 ${"+".repeat(Math.floor($worn.face.reveal / 200))}`)>>
			<<run _increaseAttractive.push(`멋진 얼굴 악세사리 ${"+".repeat(Math.floor($worn.face.reveal / 200))}`)>>
		<</if>>
		<<if $worn.neck.reveal gte 50>>
			<<run _increaseAllure.push(`매혹적인 목걸이 ${"+".repeat(Math.floor($worn.neck.reveal / 200))}`)>>
			<<run _increaseAttractive.push(`멋진 목걸이 ${"+".repeat(Math.floor($worn.neck.reveal / 200))}`)>>
		<</if>>
		<<if $worn.legs.reveal gte 50>>
			<<run _increaseAllure.push(`매혹적인 레그웨어 ${"+".repeat(Math.floor($worn.legs.reveal / 200))}`)>>
			<<run _increaseAttractive.push(`멋진 레그웨어 ${"+".repeat(Math.floor($worn.legs.reveal / 200))}`)>>
		<</if>>
		<<if $worn.feet.reveal gte 50>>
			<<run _increaseAllure.push(`매혹적인 신발 ${"+".repeat(Math.floor($worn.feet.reveal / 200))}`)>>
			<<run _increaseAttractive.push(`멋진 신발 ${"+".repeat(Math.floor($worn.feet.reveal / 200))}`)>>
		<</if>>
		<<if Weather.dayState is "night">>
			<<run _increaseAllure.push("밤")>>
		<</if>>
		<<if $exposed gte 1>>
			<<run _increaseAllure.push("노출")>>
		<</if>>
		<<if $liquidcount gte 1>>
			<<run _increaseAllure.push("정액 냄새")>>
		<</if>>
		<<if $liquidcount gte 10>>
			<<run _increaseAllure.push("정액에 뒤덮힘")>>
		<</if>>
		<<if $liquidcount gte 30>>
			<<run _increaseAllure.push("정액에 적셔짐")>>
		<</if>>
		<<if Time.isBloodMoon()>>
			<<run _increaseAllure.push("보름달")>>
		<</if>>
		<<if $auriga_scar gte 1>>
			<<run _increaseAllure.push(`엘크 상처 ${"+".repeat($auriga_scar)}`)>>
		<</if>>
		<<set _negLabels = [
			{ threshold: 1000, class: "red", label: "악명 높은" },
			{ threshold: 600, class: "pink", label: "유명한" },
			{ threshold: 400, class: "purple", label: "잘 알려진" },
			{ threshold: 200, class: "blue", label: "알려진" },
			{ threshold: 100, class: "lblue", label: "약간 알려진" },
			{ threshold: 30, class: "teal", label: "잘 알려지지 않은" }
		]>>
		<<set _posLabels = [
			{ threshold: 1000, class: "green", label: "명성 자자한" },
			{ threshold: 600, class: "teal", label: "유명한" },
			{ threshold: 400, class: "lblue", label: "잘 알려진" },
			{ threshold: 200, class: "blue", label: "알려진" },
			{ threshold: 100, class: "purple", label: "약간 알려진" },
			{ threshold: 30, class: "pink", label: "잘 알려지지 않은" }
		]>>
		<<set _neg = [
			{ type: "sex", name: "걸레" },
			{ type: "prostitution", name: "창녀" },
			{ type: "rape", name: "육변기" },
			{ type: "bestiality", name: $settings.bestialityEnabled ? "암캐" : "수간충" },
			{ type: "exhibitionism", name: "과시자" },
			{ type: "pregnancy", name: $fame.pregnancy gte 1000 ? "번식 엄마" : ($fame.pregnancy gte 400 ? "번식자" : "애엄마") },
			{ type: "impreg", name: $fame.impreg gte 1000 ? "모두의 아버지" : ($fame.impreg gte 400 ? "아빠" : "씨돼지") },
		]>>
		<<set _pos = [
			{ type: "scrap", name: "싸움꾼" },
			{ type: "good", name: "박애주의자" },
			{ type: "business", name: "사업가" },
			{ type: "social", name: $fame.social gte 1000 ? "달변가" : "사교계 인사" },
			{ type: "model", name: $fame.model gte 1000 ? "자랑꾼" : "모델" },
		]>>
		<<set _decreaseAllure to _pos.some(fame => (_posLabels.some(status => $fame[fame.type] >= status.threshold)))>>

		<div class="settingsHeader">매력</div>
		<div class="settingsToggleItemWide">
			<i>매력</i>은 겉모습으로 인한 이점을 이용할 수 있는 능력을 나타냅니다.
			<br>
			매력 점수:
			<<if $attractiveness gte 5000>>
				<span class="green">S</span>
			<<elseif $attractiveness gte 4000>>
				<span class="teal">A</span>
			<<elseif $attractiveness gte 3000>>
				<span class="lblue">B</span>
			<<elseif $attractiveness gte 2000>>
				<span class="blue">C</span>
			<<elseif $attractiveness gte 1000>>
				<span class="purple">D</span>
			<<else>>
				<span class="pink">F</span>
			<</if>>
		</div>
		<div class="settingsToggleItemWide">
			<span class="gold bold">기여 요인:</span>
			<br>
			<span class="green">
				<<for _item range _increaseAttractive>>
					<<= _item>>
					<br>
				<</for>>
			</span>
		</div>
	</div>
	<hr>
	<div class="settingsGrid">
		<div class="settingsHeader">색기</div>
		<div class="settingsToggleItemWide">
			<i>색기</i>는 매력의 어두운 면모로, 얼마나 많은 사람들이 당신을 범하고 싶어하는지를 나타냅니다.
			<br>
			색기:
			<<if $allure gte 6000 * $settings.allureModifier>>
				<span class="red">금방이라도 유린당할 것처럼 보인다.</span>
			<<elseif $allure gte 4000 * $settings.allureModifier>>
				<span class="pink">당신은 변태처럼 보인다.</span>
			<<elseif $allure gte 3000 * $settings.allureModifier>>
				<span class="purple">당신은 음란하게 보인다.</span>
			<<elseif $allure gte 2000 * $settings.allureModifier>>
				<span class="blue">당신은 돋보인다.</span>
			<<elseif $allure gte 1500 * $settings.allureModifier>>
				<span class="lblue">당신은 주의를 끌고 있다.</span>
			<<elseif $allure gte 1000 * $settings.allureModifier>>
				<span class="teal">사람들이 당신에게 시선을 던지곤 한다.</span>
			<<else>>
				<span class="green">당신은 지극히 평범하다.</span>
			<</if>>
		</div>
		<div @class="_decreaseAllure ? 'settingsToggleItem' : 'settingsToggleItemWide'">
			<span class="gold bold">기여 요인:</span>
			<br>
			<span class="red">
				<<for _item range _increaseAllure>>
					<<= _item>>
					<br>
				<</for>>
			</span>
			<<if !["island"].includes($location)>>
				<<for _fame range _neg>>
					<<set _famous = _negLabels.find(status => $fame[_fame.type] >= status.threshold)>>
					<<if _famous>>
						<span @class="_famous.class">명성: <<= _famous.label>> <<= _fame.name>> <<= "+".repeat([30, 100, 200, 400, 600, 1000].indexOf(_famous.threshold))>></span>
						<br>
					<</if>>
				<</for>>
			<</if>>
		</div>
		<<if _decreaseAllure>>
			<div class="settingsToggleItem">
				<span class="gold bold">감소 요인:</span>
				<br>
				<<if !["island"].includes("location")>>
					<<for _fame range _pos>>
						<<set _famous = _posLabels.find(status => $fame[_fame.type] >= status.threshold)>>
						<<if _famous>>
							<span @class="_famous.class">명성: <<= _famous.label>> <<= _fame.name>> <<= "+".repeat([30, 100, 200, 400, 600, 1000].indexOf(_famous.threshold))>></span>
							<br>
						<</if>>
					<</for>>
				<</if>>
				<<if $moorLuck gt 5>>
					<span class="green">????</span>
					<br>
				<<elseif $moorLuck gt 0>>
					<span class="lblue">????</span>
					<br>
				<</if>>
			</div>
		<</if>>
	</div>
<</widget>>

<<widget "mirrorAppearancePregnancy">>
	당신은 <span class="lewd">임신한 소녀처럼 보인다...</span>
	<<if !$hourly.mirrorPregArousal>>
		<<set $hourly.mirrorPregArousal to true>>
		<<garousal>><<gstress>><<arousal 300>><<stress 10>>
	<</if>>
	<br><br>

	<<if getPregnancyObject().potentialFathers.length is 1>>
		<<set $_fatherName to pregnancyNameCorrection(getPregnancyObject().potentialFathers[0].source)>>
		<span class="lewd">아기 아빠는 <<print $_fatherName === "당신 자신" ? "당신이" : $_fatherName + "임이">> 확실하다.</span>
	<<else>>
		<span class="red">당신은 누가 아기 아빠일지 궁금해한다.</span>
	<</if>>
	<<set getPregnancyObject().awareOf to "mirror">>
<</widget>>

<<widget "mirrorBodywriting">>
	<<set _array to _args[0] is "visible" ? _skin_array : _hidden_writing>>
	<<for _index, _active_bodypart range _array>>
		<<if $skin[_active_bodypart].writing>>
			<<if isLoveInterest($skin[_active_bodypart].special)>>
				<<set _colour to "lewd">>
			<<elseif $skin[_active_bodypart].special isnot "none">>
				<<set _colour to "red">>
			<<elseif $skin[_active_bodypart].lewd is 1>>
				<<set _colour to "pink">>
			<<else>>
				<<set _colour to "purple">>
			<</if>>
			<<if $skin[_active_bodypart].type is "text">>
				<<set _written to "written">>
				"<span @class="_colour"><<= $skin[_active_bodypart].writing.toUpperFirst()>></span>"
			<<else>>
				<<set _written to "drawn">>
				<span @class="_colour"><<= $skin[_active_bodypart].writing>> 그림</span>
			<</if>>
			<<if $skin[_active_bodypart].arrow is 1>>
				<<if _active_bodypart is "left_cheek" or _active_bodypart is "right_cheek">>
					문구와 당신의 입을 가리키는 화살표
				<<elseif _active_bodypart is "left_bottom" or _active_bodypart is "right_bottom" or _active_bodypart is "back">>
					문구와 당신의 엉덩이를 가리키는 화살표
				<<elseif _active_bodypart is "pubic" or _active_bodypart is "left_thigh" or _active_bodypart is "right_thigh">>
					문구와 당신의 음부를 가리키는 화살표
				<</if>>
			<</if>>
			<<switch $skin[_active_bodypart].pen>>
				<<case "marker">>
					(유성펜으로 쓰여짐)
				<<case "magic">>
					(<span class="pink">인장으로 새겨짐</span>)
				<<case "tattoo">>
					(<span class="red">문신으로 새겨짐</span>)
				<<case "brand">>
					(<span class="red">낙인으로 새겨짐</span>)
				<<case "lipstick">>
					(립스틱으로 쓰여짐)
				<<case "mud">>
					(진흙으로 쓰여짐)
				<<default>>
					(평범한 펜으로 쓰여짐)
			<</switch>>
			<<= _index lt _array.length - 1 ? "<br>" : "">>
		<</if>>
	<</for>>
<</widget>>

<<widget "visual-settings">>
	<<mirroricon>><<link "뒤로">><<replace #mirror>><<mirrorMenu>><</replace>><<numberify "#passages > .passage">><<unset $mirrorMenu>><</link>>
<</widget>>

<<widget "faceStyleOptions">>
	Your current face style is:
	<<listbox "_facestyle" autoselect>>
		<<optionsfrom setup.faceStyleOptions>>
	<</listbox>>
	<br>
	<<link "Apply">>
		<<if $facestyle isnot _facestyle>>
			<<set $facestyle to _facestyle>>
			<<set $facevariant to "default">>
			<<replace "#visualsFaceVariantRadios">><<faceVariantOptions>><</replace>>
			<<updatesidebarimg true>>
		<</if>>
	<</link>>
<</widget>>

<<widget "faceVariantOptions">>
	<<if Object.keys(setup.faceVariantOptions[$facestyle]).length gt 1>>
		Your current demeanour is:
		<<listbox "$facevariant" autoselect>>
			<<optionsfrom setup.faceVariantOptions[$facestyle]>>
		<</listbox>>
		<br>
		<<run $(() => {
			$("#listbox-facevariant").on("change", () => {
				Wikifier.wikifyEval('<<updatesidebarimg true>>');
			});
		})>>
	<<else>>
		There are
		<mouse class = "gold tooltip-small" style="border-bottom-color:white">
			no alternative demeanours available.
			<span class="blue">
				Selecting a different face style may make additional demeanours available to you.
			</span>
		</mouse>
	<</if>>
<</widget>>

<<widget "mirrorSkin">>
	<<mirroricon>><<link "뒤로">><<handheldon>><<updatesidebarimg>><<replace #mirror>><<mirrorMenu>><</replace>><<numberify "#passages > .passage">><<unset $mirrorMenu>><</link>>
	<br><br>

	<div class="settingsGrid">
		<div class="settingsHeader">피부</div>
		<div class="settingsToggleItem">
			<span class="gold bold">선탠:</span>
			<br>
			<span id="sunscreenDescription">
				<<sunscreenDesc>>
			</span>
			<span id="sunscreenLinks">
				<<sunscreenLinks>>
			</span>
			<br>
			<label data-target="options.images" data-disabledif="V.options.images===0">
				<<checkbox "$options.tanLines" false true autocheck>> 의상으로 인한 태닝 라인 활성화
			</label>
			<mouse class="tooltip-small linkBlue">(?)<span>태닝 라인이 시각적으로 보이는 것을 비활성화합니다. 사이드바에서만 적용됩니다.</span></mouse>
		</div>
		<div class="settingsToggleItem">
			<span class="gold bold">피부에 묻어있는 액체:</span>
			<<if $liquidcount gt 0>>
				<<mirrorwet "목" $player.bodyliquid.neck.semen $player.bodyliquid.neck.goo $player.bodyliquid.neck.nectar>>
				<<mirrorwet "오른쪽 팔" $player.bodyliquid.rightarm.semen $player.bodyliquid.rightarm.goo $player.bodyliquid.rightarm.nectar>>
				<<mirrorwet "왼쪽 팔" $player.bodyliquid.leftarm.semen $player.bodyliquid.leftarm.goo $player.bodyliquid.leftarm.nectar>>
				<<mirrorwet "허벅지" $player.bodyliquid.thigh.semen $player.bodyliquid.thigh.goo $player.bodyliquid.thigh.nectar>>
				<<mirrorwet "엉덩이" $player.bodyliquid.bottom.semen $player.bodyliquid.bottom.goo $player.bodyliquid.bottom.nectar>>
				<<mirrorwet "배" $player.bodyliquid.tummy.semen $player.bodyliquid.tummy.goo $player.bodyliquid.tummy.nectar>>
				<<mirrorwet "가슴" $player.bodyliquid.chest.semen $player.bodyliquid.chest.goo $player.bodyliquid.chest.nectar>>
				<<mirrorwet "얼굴" $player.bodyliquid.face.semen $player.bodyliquid.face.goo $player.bodyliquid.face.nectar>>
				<<mirrorwet "머리카락" $player.bodyliquid.hair.semen $player.bodyliquid.hair.goo $player.bodyliquid.hair.nectar>>
				<<mirrorwet "발" $player.bodyliquid.feet.semen $player.bodyliquid.feet.goo $player.bodyliquid.feet.nectar>>
				<<mirrorwet "음순" $player.bodyliquid.vaginaoutside.semen $player.bodyliquid.vaginaoutside.goo $player.bodyliquid.vaginaoutside.nectar>>
				<<mirrorwet "질" $player.bodyliquid.vagina.semen $player.bodyliquid.vagina.goo $player.bodyliquid.vagina.nectar>>
				<<mirrorwet "페니스" $player.bodyliquid.penis.semen $player.bodyliquid.penis.goo $player.bodyliquid.penis.nectar>>
				<<mirrorwet "엉덩이" $player.bodyliquid.anus.semen $player.bodyliquid.anus.goo $player.bodyliquid.anus.nectar>>
				<<mirrorwet "입" $player.bodyliquid.mouth.semen $player.bodyliquid.mouth.goo $player.bodyliquid.mouth.nectar>>
			<<else>>
				<br>
				당신의 피부는 <span class="green">깨끗하다</span>.
			<</if>>

		</div>
	</div>
	<hr>
	<div class="settingsGrid">
		<<bodywritingExposureCheck true true>>
		<<bodywritingHiddenCheck true true>>
		<div class="settingsHeader">몸</div>
		<<if _bodywriting_exposed is 1 and _bodywriting_hidden is 1>>
			<div class="settingsToggleItem">
				<span class="gold bold">드러난 신체 낙서:</span>
				<br>
				<<mirrorBodywriting "visible">>
				<br>
			</div>
			<div class="settingsToggleItem">
				<span class="gold bold">숨겨진 신체 낙서:</span>
				<br>
				<<mirrorBodywriting "hidden">>
				<br>
			</div>
		<<elseif _bodywriting_exposed is 1 || _bodywriting_hidden is 1>>
			<div class="settingsToggleItemWide">
				<<if _bodywriting_exposed is 1>>
					<span class="gold bold">드러난 신체 낙서:</span>
					<br>
					<<mirrorBodywriting "visible">>
					<br>
				<<elseif _bodywriting_hidden is 1>>
					<span class="gold bold">숨겨진 신체 낙서:</span>
					<br>
					<<mirrorBodywriting "hidden">>
					<br>
				<</if>>
			</div>
		<</if>>

		<div class="settingsToggleItemWide">
			<<if $bodyWritingSelected is null>>
				<<unset $bodyWritingSelected>>
			<</if>>
			<<if $bodyWritingSelected isnot undefined>>
				당신은
				<<if isLoveInterest($skin[$bodyPartSelected].special)>>
					"<span class="lewd"><<print $bodyWritingSelected>></span>"라고
				<<elseif $skin[$bodyPartSelected].special isnot "none">>
					"<span class="red"><<print $bodyWritingSelected>></span>"라고
				<<elseif $skin[$bodyPartSelected].lewd is 1>>
					"<span class="pink"><<print $bodyWritingSelected>></span>"라고
				<<else>>
					"<span class="purple"><<print $bodyWritingSelected>></span>"라고
				<</if>>
				쓴다.
				<<unset $bodyWritingSelected>>
				<<unset $bodyPartSelected>>
				<hr>
			<</if>>

			<<bodywritingOptions>>

			/*Needs to be last*/
			<div class="mirrorContainer">
				<<bodywritingMenuLinks>>
			</div>
		</div>
		<div class="settingsToggleItemWide">
			<span class="gold bold">체형:</span>
			<mouse class="tooltip-small linkBlue">(?)<span>외관에 대한 것으로, 성별에 따른 외형 변화와는 무관합니다.</span></mouse>
			<br>
			현재 당신의 체형:
			<span class="capitalize">
				<<listbox "$player.bodyshape" autoselect>>
					<<optionsfrom setup.bodyShapes>>
				<</listbox>>
			</span>
			<br>
			<<run $(() => {
				$("#listbox-playerbodyshape").on("change", () => {
					Wikifier.wikifyEval('<<updatesidebarimg true>>');
				});
			})>>
		</div>
	</div>
	<hr>
	<div class="settingsGrid">

		<div class="settingsHeader">얼굴 설정</div>
		<<if setup.faceStyleOptions.length gt 1>>
			<div id="visualsFaceStyle" class="settingsToggleItem">
				<span class="gold bold">얼굴 스타일:</span><br>
				<<faceStyleOptions>>
			</div>
		<</if>>

		<div id="visualsFaceVariants" @class="setup.faceStyleOptions.length gt 1 ? 'settingsToggleItem' : 'settingsToggleItemWide'">
			<span class="gold bold">분위기:</span>
			<br>
			<div id="visualsFaceVariantRadios">
				<<faceVariantOptions>>
			</div>
		</div>
	</div>
<</widget>>

<<widget "sunscreenLinks">>
	<<if Skin.Sunscreen.isApplied()>>
		<br>
		<<cosmeticsicon "sunscreen">><<link "Remove sunscreen">>
			<<handheldon>>
			<<set Skin.Sunscreen.autoApply to false>>
			<<replace #sunscreenDescription>><<sunscreenApply "remove">><</replace>>
			<<replace #sunscreenLinks>><<sunscreenLinks>><</replace>>
		<</link>> <<note `Skin.Sunscreen.usesLeft + ' use'+(Skin.Sunscreen.usesLeft > 1 ? 's' : '') + ' left'`>>
	<<else>>
		<<if Skin.Sunscreen.usesLeft gt 0>>
			<br>
			<<cosmeticsicon "sunscreen">><<link "Apply sunscreen">>
				<<handheldon>>
				<<replace #sunscreenDescription>><<sunscreenApply>><</replace>>
				<<replace #sunscreenLinks>><<sunscreenLinks>><</replace>>
			<</link>> <<note `Skin.Sunscreen.usesLeft + ' use'+(Skin.Sunscreen.usesLeft > 1 ? 's' : '') + ' left'`>>
		<</if>>
	<</if>>
	<br>
	<<if Skin.Sunscreen.usesLeft gt 0>>
		<<ind>><<link `Skin.Sunscreen.autoApply ? "Stop applying" : "Apply when required"`>>
			<<set Skin.Sunscreen.autoApply to !Skin.Sunscreen.autoApply>>
			<<replace #sunscreenLinks>><<sunscreenLinks>><</replace>>
		<</link>>
	<</if>>
<</widget>>

<<widget "sunscreenDesc">>
	당신의 피부는
	<<if Skin.Sunscreen.isApplied()>>
		<mouse class = "gold tooltip-small" style="border-bottom-color:white">
			태양빛으로부터 보호받고 있다.
			<span class="black">
				선크림이 당신의 피부가 타는 것을 막아주고 있다.
				<<if Skin.Sunscreen.usesLeft is 0>>
					<br>
					<i class="blue">선크림은 화장품 가게에서 구매할 수 있다.</i>
				<</if>>
			</span>
		</mouse>
		<<set $_timeLeft to Math.floor(Skin.Sunscreen.timeLeft / 60)>>
		(<<print getTimeString($_timeLeft)>> left).
	<<else>>
		<mouse class = "gold tooltip-small" style="border-bottom-color:white">
			태양빛으로부터 보호받지 못하고 있다.
			<span class="black">
				당신의 피부는 태양빛에 노출되면 타게 될 것이다.
				<<if Skin.Sunscreen.usesLeft is 0>>
					<br>
					<i class="blue">선크림은 화장품 가게에서 구매할 수 있다.</i>
				<</if>>
			</span>
		</mouse>
	<</if>>
<</widget>>

<<widget "sunscreenApply">>
	<<if !pcAreArmsBound("any")>>
		<<if _args[0] is "remove">>
			<<run Skin.Sunscreen.remove()>>
		<<else>>
			<<run Skin.Sunscreen.apply()>>
		<</if>>
	<</if>>
	<<if pcAreArmsBound("both")>>
		<span class="red">Both of your arms are bound</span>, and you find it difficult to do anything about your skin this way.
		<hr>
	<<elseif _args[0] is "remove">>
		<<wearProp "rag" "white">><<updatesidebarimg>>
		You scrub a damp towel over your skin, removing any last traces of sunscreen.
		<hr>
	<<else>>
		<<wearProp "sunscreen">><<updatesidebarimg>>
		You squirt a hefty dollop of sunscreen onto your hand and rub it into your skin.
		<hr>
	<</if>>
	<<sunscreenDesc>>
<</widget>>

<<widget "bodywritingOptions">>
	<<set _bodyWritingOptions to {
		General: {
		"Cute boy":"cute_boy",
		"Cute girl":"cute_girl",
		"Orphan":"orphan"
		}
	}>>

	<<if $beauty gte ($beautymax / 7) * 3>>
		<<set _bodyWritingOptions.General["Handsome"] to "handsome">>
		<<set _bodyWritingOptions.General["Pretty"] to "pretty">>
	<</if>>
	<<if $beauty gte ($beautymax / 7) * 4>>
		<<set _bodyWritingOptions.General["Stud"] to "stud">>
		<<set _bodyWritingOptions.General["Beauty"] to "beauty">>
	<</if>>
	<<if $beauty gte ($beautymax / 7) * 5>>
		<<set _bodyWritingOptions.General["Beautiful"] to "beautiful">>
	<</if>>

	<<if $trauma gte (($traumamax / 5) * 2)>>
		<<set _bodyWritingOptions.General["Daddy issues"] to "daddy_issues">>
		<<set _bodyWritingOptions.General["Mummy issues"] to "mummy_issues">>
		<<set _bodyWritingOptions.General["Trashy"] to "trashy">>
	<</if>>
	<<if $trauma gte (($traumamax / 5) * 3)>>
		<<set _bodyWritingOptions.General["Worthless"] to "worthless">>
		<<set _bodyWritingOptions.General["Oh no"] to "oh_no">>
		<<set _bodyWritingOptions.General["Dumb bitch"] to "dumb_bitch">>
	<</if>>

	<<if hasSexStat("promiscuity", 2)>>
		<<set _bodyWritingOptions.General["Hot"] to "hot">>
	<</if>>
	<<if hasSexStat("promiscuity", 3)>>
		<<set _bodyWritingOptions.Promiscuity = {}>>
		<<set _bodyWritingOptions.Promiscuity["Slut"] to "slut">>
		<<set _bodyWritingOptions.Promiscuity["Promiscuous"] to "promiscuous">>
		<<set _bodyWritingOptions.Promiscuity["Wanton"] to "wanton">>
		<<set _bodyWritingOptions.Promiscuity["D.T.F."] to "dtf">>
	<</if>>

	<<if hasSexStat("promiscuity", 4)>>
		<<set _bodyWritingOptions.Promiscuity["Insatiable slut"] to "insatiable_slut">>
		<<set _bodyWritingOptions.Promiscuity["Free Sex"] to "free_sex">>
		<<set _bodyWritingOptions.Promiscuity["Town bicycle"] to "town_bicycle">>
		<<set _bodyWritingOptions.Promiscuity["Size queen"] to "size_queen">>
		<<if $orgasmtrait gte 1>>
			<<set _bodyWritingOptions.Promiscuity["Sex addict"] to "sex_addict">>
			<<set _bodyWritingOptions.Promiscuity["Make me cum"] to "make_me_cum">>
		<</if>>
	<</if>>

	<<if hasSexStat("promiscuity", 5)>>
		<<set _bodyWritingOptions.Promiscuity["Fuck Me"] to "fuck_me">>
		<<set _bodyWritingOptions.Promiscuity["Cocksucker"] to "cocksucker">>
		<<set _bodyWritingOptions.Promiscuity["Cum dump"] to "cum_dump">>
		<<set _bodyWritingOptions.Promiscuity["Public Slut"] to "public_slut">>
		<<if $analstat gte 100>>
			<<set _bodyWritingOptions.Promiscuity["Buttslut"] to "buttslut">>
			<<set _bodyWritingOptions.Promiscuity["Anal whore"] to "anal_whore">>
		<</if>>
	<</if>>

	<<if hasSexStat("promiscuity", 3)>>
		<<set _bodyWritingOptions.Prostitution = {}>>
		<<if $trauma gte (($traumamax / 5) * 2)>>
			<<set _bodyWritingOptions.Prostitution["It's not rape if you pay me"] to "its_not_rape_if_you_pay_me">>
		<</if>>
		<<set _bodyWritingOptions.Prostitution["£5 whore"] to "five_pound_whore">>
		<<set _bodyWritingOptions.Prostitution["£10 a pop"] to "ten_pound_a_pop">>
		<<set _bodyWritingOptions.Prostitution["Slut for hire"] to "slut_for_hire">>
	<</if>>
	<<if hasSexStat("promiscuity", 4)>>
		<<set _bodyWritingOptions.Prostitution["£25 per fuck"] to "twenty_five_pound_per_fuck">>
		<<set _bodyWritingOptions.Prostitution["£100"] to "one_hundred_pound">>
		<<set _bodyWritingOptions.Prostitution["Body for sale"] to "body_for_sale">>
		<<if $trauma gte (($traumamax / 5) * 3)>>
			<<set _bodyWritingOptions.Prostitution["Stupid whore"] to "stupid_whore">>
		<<else>>
			<<set _bodyWritingOptions.Prostitution["Whore"] to "whore">>
		<</if>>
		<<set _bodyWritingOptions.Prostitution["Prostitute"] to "prostitute">>
	<</if>>
	<<if hasSexStat("exhibitionism", 3)>>
		<<set _bodyWritingOptions.Exhibitionism to {}>>
		<<set _bodyWritingOptions.Exhibitionism["Pervert"] to "pervert">>
		<<set _bodyWritingOptions.Exhibitionism["Attention whore"] to "attention_whore">>
		<<set _bodyWritingOptions.Exhibitionism["Flaunter"] to "flaunter">>
		<<set _bodyWritingOptions.Exhibitionism["Object"] to "object">>
		<<set _bodyWritingOptions.Exhibitionism["Strip me"] to "strip_me">>
		<<set _bodyWritingOptions.Exhibitionism["Ask to see me naked"] to "ask_to_see_me_naked">>
	<</if>>
	<<if hasSexStat("deviancy", 4)>>
		<<set _bodyWritingOptions.Deviancy to {}>>
		<<set _bodyWritingOptions.Deviancy["Doggy slut"] to "doggy_slut">>
		<<set _bodyWritingOptions.Deviancy["Animal"] to "animal">>
		<<set _bodyWritingOptions.Deviancy["Beast fucker"] to "beast_fucker">>
		<<set _bodyWritingOptions.Deviancy["Breedable"] to "breedable">>
		<<set _bodyWritingOptions.Deviancy["Deviant"] to "deviant">>
	<</if>>
	<<if $masochism_level gte 1>>
		<<set _bodyWritingOptions.Masochism to {}>>
		<<set _bodyWritingOptions.Masochism["Hit me"] to "hit_me">>
		<<set _bodyWritingOptions.Masochism["Hurt me"] to "hurt_me">>
		<<set _bodyWritingOptions.Masochism["Treat me bad"] to "treat_me_bad">>
		<<set _bodyWritingOptions.Masochism["Make me squeal"] to "make_me_squeal">>
	<</if>>
	<<if $submissive gte 1200>>
		<<set _bodyWritingOptions.Submission to {}>>
		<<set _bodyWritingOptions.Submission["Submissive"] to "submissive">>
		<<set _bodyWritingOptions.Submission["Pet"] to "pet">>

			<<if hasSexStat("deviancy", 3)>>
				<<set _bodyWritingOptions.Submission["Public pet"] to "public_pet">>
			<</if>>

		<<if hasSexStat("promiscuity", 4)>>
			<<set _bodyWritingOptions.Submission["Free use"] to "free_use">>
			<<set _bodyWritingOptions.Submission["Use Me"] to "use_me">>
		<</if>>

		<<if $submissive gte 1500>>
			<<set _bodyWritingOptions.Submission["Slave"] to "slave">>
			<<set _bodyWritingOptions.Submission["Enslave Me"] to "enslave_me">>
			<<set _bodyWritingOptions.Submission["Cum rag"] to "cum_rag">>
			<<if hasSexStat("promiscuity", 5)>>
				<<set _bodyWritingOptions.Submission["Fuckdoll"] to "fuckdoll">>
				<<set _bodyWritingOptions.Submission["Fucktoy"] to "fucktoy">>
				<<if $player.penisExist>>
					<<set _bodyWritingOptions.Submission["Walking dildo"] to "walking_dildo">>
				<</if>>
			<</if>>
		<</if>>
	<</if>>
	<<if ($player.vaginaExist or ($sexStats.anus.pregnancy.awareOf or $sexStats.anus.pregnancy.givenBirth gte 1)) and hasSexStat("promiscuity", 5)>>
		<<set _bodyWritingOptions.Pregnancy to {}>>
		<<set _bodyWritingOptions.Pregnancy["Brood mother"] to "brood_mother">>
		<<set _bodyWritingOptions.Pregnancy["Inseminate me"] to "inseminate_me">>
		<<set _bodyWritingOptions.Pregnancy["Impregnate me"] to "impregnate_me">>
		<<set _bodyWritingOptions.Pregnancy["Pregnancy slut"] to "pregnancy_slut">>
		<<set _bodyWritingOptions.Pregnancy["Breeding ground"] to "breeding_ground">>
	<</if>>

	<<set _bodyWritingOptions["Love Interests"] to {}>>
	<<if isPossibleLoveInterest("Robin")>>
		<<set _bodyWritingOptions["Love Interests"]["Robin's Protector"] to "robins_protector">>
		<<set _bodyWritingOptions["Love Interests"]["Robin & I"] to "robin_and_i">>
		<<set _bodyWritingOptions["Love Interests"]["The Orphan Lover"] to "the_orphan_lover">>
		<<if ($player.penisExist or $player.gender_appearance is "m" or $backgroundTraits.includes("crossdresser"))>>
			<<set _bodyWritingOptions["Love Interests"]["Robin's Boyfriend"] to "robins_boyfriend">>
		<</if>>
		<<if ($player.vaginaExist or $player.gender_appearance is "f" or $backgroundTraits.includes("crossdresser"))>>
			<<set _bodyWritingOptions["Love Interests"]["Robin's Girlfriend"] to "robins_girlfriend">>
		<</if>>
	<</if>>
	<<if isPossibleLoveInterest("Whitney")>>
		<<set _bodyWritingOptions["Love Interests"]["Whitney's Pet"] to "whitneys_pet">>
		<<set _bodyWritingOptions["Love Interests"]["Property of Whitney"] to "property_of_whitney">>
		<<set _bodyWritingOptions["Love Interests"]["Whitney's Toy"] to "whitneys_toy">>
		<<if ($player.penisExist or $player.gender_appearance is "m" or $backgroundTraits.includes("crossdresser"))>>
			<<set _bodyWritingOptions["Love Interests"]["Whitney's Boyslut"] to "whitneys_boyslut">>
		<</if>>
		<<if ($player.vaginaExist or $player.gender_appearance is "f" or $backgroundTraits.includes("crossdresser"))>>
			<<set _bodyWritingOptions["Love Interests"]["Whitney's Slut"] to "whitneys_slut">>
		<</if>>
	<</if>>
	<<if isPossibleLoveInterest("Kylar")>>
		<<set _bodyWritingOptions["Love Interests"]["Kylar's Obsession"] to "kylars_obsession">>
		<<set _bodyWritingOptions["Love Interests"]["Love Kylar Forever"] to "love_kylar_forever">>
		<<set _bodyWritingOptions["Love Interests"]["Reserved for Kylar"] to "reserved_for_kylar">>
		<<set _bodyWritingOptions["Love Interests"]["Just Kylar"] to "just_kylar">>
	<</if>>
	<<if isPossibleLoveInterest("Eden")>>
		<<set _bodyWritingOptions["Love Interests"]["Eden's Companion"] to "edens_companion">>
		<<set _bodyWritingOptions["Love Interests"]["Hunter and Prey"] to "hunter_and_prey">>
		<<set _bodyWritingOptions["Love Interests"]["It's Lonely in the Woods"] to "its_lonely_in_the_woods">>
		<<set _bodyWritingOptions["Love Interests"]["Something is Hunting you"] to "something_is_hunting_you">>
	<</if>>
	<<if isPossibleLoveInterest("Avery")>>
		<<set _bodyWritingOptions["Love Interests"]["Avery's Trophy"] to "averys_trophy">>
		<<set _bodyWritingOptions["Love Interests"]["Endearing"] to "endearing">>
		<<if ($player.penisExist or $player.gender_appearance is "m" or $backgroundTraits.includes("crossdresser"))>>
			<<set _bodyWritingOptions["Love Interests"]["Uptown Boy"] to "uptown_boy">>
		<</if>>
		<<if ($player.vaginaExist or $player.gender_appearance is "f" or $backgroundTraits.includes("crossdresser"))>>
			<<set _bodyWritingOptions["Love Interests"]["Uptown Girl"] to "uptown_girl">>
		<</if>>
		<<set _bodyWritingOptions["Love Interests"]["Avery's Monopoly"] to "averys_monopoly">>
	<</if>>
	<<if isPossibleLoveInterest("Alex")>>
		<<set _bodyWritingOptions["Love Interests"]["Alex's Partner"] to "alexs_partner">>
		<<set _bodyWritingOptions["Love Interests"]["Sunrise to Sunset"] to "sunrise_to_sunset">>
		<<set _bodyWritingOptions["Love Interests"]["Hay Baler"] to "hay_baler">>
		<<if ($player.penisExist or $player.gender_appearance is "m" or $backgroundTraits.includes("crossdresser"))>>
			<<set _bodyWritingOptions["Love Interests"]["Cowboy"] to "cowboy">>
		<</if>>
		<<if ($player.vaginaExist or $player.gender_appearance is "f" or $backgroundTraits.includes("crossdresser"))>>
			<<set _bodyWritingOptions["Love Interests"]["Cowgirl"] to "cowgirl">>
		<</if>>
	<</if>>
	<<if isPossibleLoveInterest("Sydney")>>
		<<set _bodyWritingOptions["Love Interests"]["Sydney's Saviour"] to "sydneys_savior">>
		<<set _bodyWritingOptions["Love Interests"]["Bound to Sydney"] to "bound_to_sydney">>
		<<set _bodyWritingOptions["Love Interests"]["Sydney Makes Me :)"] to "sydney_makes_me_smile">>
		<<if C.npc.Sydney.purity gt 1>>
			<<set _bodyWritingOptions["Love Interests"]["Purest Love"] to "purest_love">>
		<<else>>
			<<set _bodyWritingOptions["Love Interests"]["Lusty Sinners"] to "lusty_sinners">>
		<</if>>
	<</if>>
	<<if isPossibleLoveInterest("Black Wolf")>>
		<<set _bodyWritingOptions["Love Interests"]["Black Wolf's Bitch"] to "black_wolfs_bitch">>
		<<set _bodyWritingOptions["Love Interests"]["All for my Alpha"] to "all_for_my_alpha">>
		<<if $wolfpackleader is 1>>
			<<set _bodyWritingOptions["Love Interests"]["Leader of the Pack"] to "leader_of_the_pack">>
		<</if>>
		<<set _bodyWritingOptions["Love Interests"]["Runs With Wolves"] to "runs_with_wolves">>
	<</if>>
	<<if isPossibleLoveInterest("Great Hawk")>>
		<<set _bodyWritingOptions["Love Interests"]["Great Hawk's Spouse"] to "great_hawks_spouse">>
		<<set _bodyWritingOptions["Love Interests"]["Soaring With Love"] to "soaring_with_love">>
		<<set _bodyWritingOptions["Love Interests"]["Terror's Mate"] to "terrors_mate">>
		<<set _bodyWritingOptions["Love Interests"]["Free Bird"] to "free_bird">>
	<</if>>
	<<if isPossibleLoveInterest("Gwylan")>>
		<<set _bodyWritingOptions["Love Interests"]["Witch's Ward"] to "witchs_ward">>
		<<set _bodyWritingOptions["Love Interests"]["Witch's Familiar"] to "witchs_familiar">>
		<<set _bodyWritingOptions["Love Interests"]["Gwylan's Treasure"] to "gwylans_treasure">>
		<<set _bodyWritingOptions["Love Interests"]["Gwylan's Apprentice"] to "gwylans_apprentice">>
		<<set _bodyWritingOptions["Love Interests"]["Forever Yearning"] to "forever_yearning">>
	<</if>>
	<<if $debug is 1>>
		<<set _bodyWritingOptions["Debug"] to setup.bodywriting>>
		<<set _debugBodywritingOptionsKeys to Object.keys(setup.bodywriting)>>
		<<link [[Wash yourself|$passage]]>>
			<<set $mirrorMenu to "skin">>
			<<wash>>
		<</link>>
		<<link [[Bind hands|$passage]]>>
			<<set $mirrorMenu to "skin">>
			<<bind>>
		<</link>><span class="black"> (Will destroy handheld items.)</span>
		<br/>
		<<print Object.values(setup.bodywriting).length>> known bodywriting options.
	<</if>>
<</widget>>

<<widget "bodywritingMenuLinks">>
	<span class="gold bold">Add Bodywriting:</span>
	<br>
	<div id="bodywritingMenuLinks">
		<<set _keys to Object.keys(_bodyWritingOptions)>>
		<<if $bodywritingSet is undefined>>
			<<set $bodywritingSet to "General">>
		<</if>>
		<<for _i to 0; _i lt _keys.length; _i++>>
			<<capture _i _keys>>
				<div @id="'link-'+_keys[_i].replace(/ /g,'-')" @class="(_keys[_i] is $bodywritingSet ? 'no-numberify bodywritingSelected' : 'no-numberify bodywriting')">
				<<button _keys[_i]>>
					<<removeclass `'#link-'+$bodywritingSet.replace(/ /g,'-')` "bodywritingSelected">>
					<<addclass `'#link-'+$bodywritingSet.replace(/ /g,'-')` "bodywriting">>
					<<set $bodywritingSet to clone(_keys[_i])>>
					<<addclass `'#link-'+$bodywritingSet.replace(/ /g,'-')` "bodywritingSelected">>
					<<replace "#bodywritingMenu">><<bodywritingMenu _args[0]>><</replace>>
				<</button>>
				</div>
			<</capture>>
		<</for>>
	</div>

	<br>
	<div id="bodywritingMenu" class="skinMenu no-numberify">
		<<bodywritingMenu _args[0]>>
	</div>
	<div class="skinMenu">
		<label data-target="options.images" data-disabledif="V.options.images===0">
			<<checkbox "$options.bodywritingImages" false true autocheck>> Enable bodywriting images
		</label>
	</div>
<</widget>>

<<widget "bodywritingMenu">>
	<<if Object.keys(_bodyWritingOptions[$bodywritingSet]).length gt 0>>
		<<set _bodyPartOptions to {}>>
		<<if _args[0] isnot undefined>>
			<<set _bodyPartOptionsSkip to _args[0]>>
		<<else>>
			<<set _bodyPartOptionsSkip to ["back", "left_bottom", "right_bottom"]>>
		<</if>>
		<<for _label, _value range $skin>>
			<<if _bodyPartOptionsSkip.includes(_label)>>
				<<continue>>
			<<elseif Object.keys(_value).length is 0>>
				<<silently>><<bodypart _label>><</silently>>
				<<set _bodyPartOptions[_text_output.toUpperFirst()] to _label>>
			<</if>>
		<</for>>
		<<if $debug is 1>>
			Write
			<<listbox "_bodyWritingDebugSelected">>
				<<optionsfrom _bodyWritingOptions[$bodywritingSet]>>
			<</listbox>>
			everywhere
			<<link [[Confirm|$passage]]>>
				<<set $mirrorMenu to "skin">>
				<<for _part, _value range $skin>>
					<<add_bodywriting _part _bodyWritingDebugSelected "pen">>
				<</for>>
			<</link>>
			<br />
			Write
			<<listbox "_bodyWritingDebugSelected">>
				<<optionsfrom _bodyWritingOptions[$bodywritingSet]>>
			<</listbox>>
			everywhere where it has custom sprites


			<<link [[Confirm|$passage]]>>
				<<set $mirrorMenu to "skin">>
				<<for _part, _value range $skin>>
					<<if _bodyWritingDebugSelected.sprites.includes(_part)>>
						<<add_bodywriting _part _bodyWritingDebugSelected "pen">>
					<</if>>
				<</for>>
			<</link>>
			<br />
			<br />
		<</if>>

		<<if Object.keys(_bodyPartOptions).length gt 0>>
			Write
			<<listbox "_bodyWritingSelected">>
				<<optionsfrom _bodyWritingOptions[$bodywritingSet]>>
			<</listbox>>
			on your
			<<listbox "_bodyPartSelected">>
				<<optionsfrom _bodyPartOptions>>
			<</listbox>>

			<<link [[Confirm|$passage]]>>
				<<set $mirrorMenu to "skin">>
				<<set $bodyWritingSelected to Object.keys(_bodyWritingOptions[$bodywritingSet])[Object.values(_bodyWritingOptions[$bodywritingSet]).indexOf(_bodyWritingSelected)]>>
				<<set $bodyPartSelected to _bodyPartSelected>>
				<<add_bodywriting _bodyPartSelected _bodyWritingSelected "pen">>
			<</link>>
		<<else>>
			<span class="blue">You're not sure where else you can write an advertisement.</span>
		<</if>>
	<<else>>
		<span class="blue">You have not unlocked any bodywriting options for this category yet.</span>
	<</if>>
<</widget>>

<<widget "hairDescription">>
	You check your hair in the mirror.
	<<if $hairtype is "default" and $fringetype is "default">>
	Your hair is not currently styled. Your sides are positioned <<if $hairposition is "front">>in front of<<else>>behind<</if>> your body.
	Your hair
	<<if $hairgelBottles is undefined>><<set $hairgelBottles to 0>><</if>>
	<<if $earsposition is "front">>
			<span class="gold"> is tucked behind your ears</span>
	<<else>>
			<span class="gold">hangs in front of your ears</span>
	<</if>>
	and is
	<<if $ruffledisable is "t">>
		<mouse class = "gold tooltip-small" style="border-bottom-color:white">
			fixed in place.
			<span class="black">Your hairstyle cannot be ruined. <br> <i class="red">Selecting a new hairstyle will re-enable hair ruffling. <<print ($hairgelBottles is 0 ? "Hair gel can be acquired at the shops." : "Hair gel will need to be re-applied.")>></i></span>
		</mouse>
	<<else>>
		<mouse class = "gold tooltip-small" style="border-bottom-color:white">
			not fixed in place.
			<span class="black">Certain situations may change your hair to a messier style. <br> <i class="teal">You can apply hair gel to disable hair ruffling.<<print ($hairgelBottles is 0 ? " Hair gel can be acquired at the shops." : "")>></i> </span>
		</mouse>
	<</if>>
		<div class="no-numberify">
			<<link [[Randomise your hairstyle|$passage]]>>
				<<set _hairType to Object.values(_hairTypeByName)>>
				<<set $hairtype to _hairType[random(0,_hairType.length - 1)]>>
				<<set _fringeType to Object.values(_fringeTypeByName)>>
				<<set $fringetype to _fringeType[random(0,_fringeType.length - 1)]>>
				<<set $hairposition to ["front","back"][random(0,1)]>>
			<</link>>
			|
			<<switch $hairposition>>
				<<case "front">>
					<<link "Position sides behind body">>
						<<run State.setVar("$hairposition", "back")>>
						<<run Engine.show()>>
					<</link>>
				<<case "back">>
					<<link "Position sides in front of body">>
						<<run State.setVar("$hairposition", "front")>>
						<<run Engine.show()>>
					<</link>>
				<<default>>
					<<link "Position sides in front of body">>
						<<run State.setVar("$hairposition", "front")>>
						<<run Engine.show()>>
					<</link>>
			<</switch>>
			|
			<<switch $earsposition>>
				<<case "front">>
					<<link "Position hair in front of ears">>
						<<run State.setVar("$earsposition", "back")>>
						<<run Engine.show()>>
					<</link>>
				<<case "back">>
					<<link "Tuck hair behind ears">>
						<<run State.setVar("$earsposition", "front")>>
						<<run Engine.show()>>
					<</link>>
				<<default>>
					<<link "Tuck hair behind ears">>
						<<run State.setVar("$earsposition", "front")>>
						<<run Engine.show()>>
					<</link>>
			<</switch>>
			|
			<<switch $browsposition>>
				<<case "front">>
					<<link "Position brows behind hair">>
						<<run State.setVar("$browsposition", "back")>>
						<<run Engine.show()>>
					<</link>>
				<<case "back">>
					<<link "Position brows in front of hair">>
						<<run State.setVar("$browsposition", "front")>>
						<<run Engine.show()>>
					<</link>>
				<<default>>
					<<link "Position brows behind hair">>
						<<run State.setVar("$browsposition", "back")>>
						<<run Engine.show()>>
					<</link>>
			<</switch>>
			<br><br>
		</div>
	<<else>>
		<<if $hairtype is "default">>
			Currently, your fringe is in the <span class="gold">$fringetype</span> style. Your sides are left <span class="gold">natural</span> and are positioned <<if $hairposition is "front">>in front of<<else>>behind<</if>> your body.
		<<elseif $fringetype is "default">>
			Currently, your fringe is left <span class="gold">natural</span>. Your sides are in the <span class="gold">$hairtype</span> style and are positioned <<if $hairposition is "front">>in front of<<else>>behind<</if>> your body.
		<<else>>
			Currently, your fringe is in the <span class="gold">$fringetype</span> style. Your sides are in the <span class="gold">$hairtype</span> style and are positioned <<if $hairposition is "front">>in front of<<else>>behind<</if>> your body.
		<</if>>
			Your hair
			<<if $hairgelBottles is undefined>><<set $hairgelBottles to 0>><</if>>
			<<if $earsposition is "front">>
				<span class="gold"> is tucked behind your ears</span>
			<<else>>
				<span class="gold">hangs in front of your ears</span>
			<</if>>
			and is
			<<if $ruffledisable is "t">>
				<mouse class = "gold tooltip-small" style="border-bottom-color:white">
					fixed in place.
					<span class="black">Your hairstyle cannot be ruined. <br> <i class="red">Selecting a new hairstyle will re-enable hair ruffling. <<print ($hairgelBottles is 0 ? "Hair gel can be acquired at the shops." : "Hair gel will need to be re-applied.")>></i></span>
				</mouse>
			<<else>>
				<mouse class = "gold tooltip-small" style="border-bottom-color:white">
					not fixed in place.
					<span class="black">Certain situations may change your hair to a messier style. <br> <i class="teal">You can apply hair gel to disable hair ruffling.<<print ($hairgelBottles is 0 ? " Hair gel can be acquired at the shops." : "")>></i> </span>
				</mouse>
			<</if>>
		<div class="no-numberify">
			<<link [[Randomise your hairstyle|$passage]]>>
				<<set _hairType to Object.values(_hairTypeByName)>>
				<<set $hairtype to _hairType[random(0,_hairType.length - 1)]>>
				<<set _fringeType to Object.values(_fringeTypeByName)>>
				<<set $fringetype to _fringeType[random(0,_fringeType.length - 1)]>>
				<<set $hairposition to ["front","back"][random(0,1)]>>
			<</link>>
			|
			<<switch $hairposition>>
				<<case "front">>
					<<link "Position sides behind body">>
						<<run State.setVar("$hairposition", "back")>>
						<<run Engine.show()>>
					<</link>>
				<<case "back">>
					<<link "Position sides in front of body">>
						<<run State.setVar("$hairposition", "front")>>
						<<run Engine.show()>>
					<</link>>
				<<default>>
					<<link "Position sides in front of body">>
						<<run State.setVar("$hairposition", "front")>>
						<<run Engine.show()>>
					<</link>>
			<</switch>>
			|
			<<switch $earsposition>>
				<<case "front">>
					<<link "Position hair in front of ears">>
						<<run State.setVar("$earsposition", "back")>>
						<<run Engine.show()>>
					<</link>>
				<<case "back">>
					<<link "Tuck hair behind ears">>
						<<run State.setVar("$earsposition", "front")>>
						<<run Engine.show()>>
					<</link>>
				<<default>>
					<<link "Tuck hair behind ears">>
						<<run State.setVar("$earsposition", "front")>>
						<<run Engine.show()>>
					<</link>>
			<</switch>>
			|
			<<switch $browsposition>>
				<<case "front">>
					<<link "Position brows behind hair">>
						<<run State.setVar("$browsposition", "back")>>
						<<run Engine.show()>>
					<</link>>
				<<case "back">>
					<<link "Position brows in front of hair">>
						<<run State.setVar("$browsposition", "front")>>
						<<run Engine.show()>>
					<</link>>
				<<default>>
					<<link "Position brows behind hair">>
						<<run State.setVar("$browsposition", "back")>>
						<<run Engine.show()>>
					<</link>>
			<</switch>>
		<br><br>
		</div>
	<</if>>
<</widget>>

<<widget "mirrorHair">>
	<<mirroricon>><<link "뒤로">><<handheldon>><<updatesidebarimg>><<replace #mirror>><<mirrorMenu>><</replace>><<numberify "#passages > .passage">><<unset $mirrorMenu>><</link>>
	<<shopClothingFilterSettingsDefault>> /* Due to reusing the traits filtering */
	<br><br>
	<div id="hairDescription">
	<<hairDescription>>
	</div>

	<div id="hairgelLinks">
		<<hairgelLinks>>
	</div>

	<br>

	<<set _hairTypeByName to {}>>
	<<run setup.hairstyles.sides.sort((a, b) => {
		if (a.name === "natural") return -1;
		if (b.name === "natural") return 1;
		return a.name.localeCompare(b.name);
	}).forEach(style => {
		if (!V.shopClothingFilter.active || !V.shopClothingFilter.traits.length || style.type.find(type => V.shopClothingFilter.traits.includes(type))) {
			T.hairTypeByName[style.name] = style.variable;
		}
	})>>
	<<set _fringeTypeByName to {}>>
	<<run setup.hairstyles.fringe.sort((a, b) => {
		if (a.name === "natural") return -1;
		if (b.name === "natural") return 1;
		return a.name.localeCompare(b.name);
	}).forEach(style => {
		if (!V.shopClothingFilter.active || !V.shopClothingFilter.traits.length || style.type.find(type => V.shopClothingFilter.traits.includes(type))) {
			T.fringeTypeByName[style.name] = style.variable;
		}
	})>>

	<div id="hairContainer">
		<div class="containerHeader" class="no-numberify">
			<<mirrorhairdisplayLinks "hair">>
		</div>
		<<mirrorhairdisplay "$hairtype" "sides">>
	</div>
	<br><br>
<</widget>>

<<widget "hairgelLinks">>
	<div class="no-numberify">
	<<link [[($showMannequins ? "Hide" : "Show") + " Mannequins"|$passage]]>><<set $showMannequins to 1 - ($showMannequins or 0)>><</link>>
	<mouse class="tooltip-small linkBlue">(?)<span>Disable preview images for hairstyles. <i class="red">Enabling mannequins may cause performance issues on some devices.</i></span></mouse>
	<<if $hairgelBottles isnot undefined and $hairgelBottles gte 1>>
		| <<hairdressericon "gel">>
		<<if $ruffledisable is "f">>
			<<link "Apply hair gel">><<replace #hairDescription>><<hairgelApply>><</replace>><<replace #hairgelDesc>><<hairgelDesc>><</replace>><<replace#hairgelLinks>><<hairgelLinks>><</replace>><</link>>
		|
		<</if>>
		<div id="hairgelDesc" style="display:inline"><<hairgelDesc>></div>
	<</if>>
	</div>
<</widget>>

<<widget "hairgelApply">>
	<<if !pcAreArmsBound("any")>>
		<<set $ruffledisable to "t">>
		<<set $hairgelBottles += -1>>
	<</if>>
	<<hairDescription>>
	<<if pcAreArmsBound("both")>>
		<span class="red">Both of your arms are bound</span>, and you find it difficult to do anything about your hair this way.
		<hr>
	<<else>>
		<<wearProp "hairgel">><<updatesidebarimg>>
		You squirt a hefty dollop of hair gel onto your hand and slick it through your hair. By the time you're finished, your hairstyle is securely in place, and the small bottle is empty. <span class="pink">If you decide to change up your hairstyle, you'll need to <<print ($hairgelBottles is 0) ? "acquire" : "apply">> more.</span>
		<hr>
	<</if>>
<</widget>>

<<widget "hairgelDesc">>
	You have <span class="gold">$hairgelBottles</span> <<pluralise $hairgelBottles "bottle">> of hair gel remaining.
<</widget>>

<<widget "mirrorhairdisplay">>
	<<if _hairCategory isnot _args[0]>>
		<<set _perPage to $showMannequins ? 14 : 100>>
		<<set _page to 1>>
	<</if>>
	<<set _hairCategory to _args[0]>>
	<<mirrorhairOptions _args[1]>>

	<div id="hairContainerElements">
		<<mirrorhairdisplayElements _hairOptions>>
	</div>
	<div id="hairContainerPages" class="no-numberify">
		<<mirrorhairControls _args[1]>>
	</div>
<</widget>>

<<widget "mirrorhairControls">>
	<<if $showMannequins>>
		<div class="containerFooter">
			<div class="tab">
			<<if _page gt 1>>
				<<button '<span class="fa-icon fa-left"></span> Previous'>>
					<<if _page gt 1>><<set _page-->><</if>>
					<<mirrorhairOptions _args[0]>>
					<<replace "#hairContainerElements">><<mirrorhairdisplayElements _hairOptions>><</replace>>
					<<replace "#hairContainerPages">><<mirrorhairControls _args[0]>><</replace>>
				<</button>>
			<<else>>
				<button class="link-internal macro-button no-numberify buttonDisabled" disabled>Previous</button>
			<</if>>
			</div>
			<div class="tab">
			<<if _page lt _pageMax>>
				<<button 'Next <span class="fa-icon fa-right"></span>'>>
					<<if _page lt _pageMax>><<set _page++>><</if>>
					<<mirrorhairOptions _args[0]>>
					<<replace "#hairContainerElements">><<mirrorhairdisplayElements _hairOptions>><</replace>>
					<<replace "#hairContainerPages">><<mirrorhairControls _args[0]>><</replace>>
				<</button>>
			<</if>>
			</div>
			<div class="tab">
				<div class="buttonPage">
					<<button '_page/_pageMax'>>
					<</button>>
				</div>
			</div>
		</div>
	<</if>>
<</widget>>

<<widget "mirrorhairTraits">>
	<div id="hairContainerFilter">
		<div class="tab">
				<<button "<span class='fa-icon fa-check'></span> Apply">>
					<<set $shopClothingFilter.active = true>>
					<<run updateMoment()>>
				<</button>>
				<<button "<span class='fa-icon fa-reset'></span> Reset Filters">>
					<<shopClothingFilterReset>>
					<<replace "#hairContainerTraits">><<mirrorHairTraitList>><</replace>>
					<<run updateMoment()>>
				<</button>>
				<<button "<span class='fa-icon fa-selected'></span> Select/Deselect All">>
					<<run toggleAllHairTraitsFilter()>>
				<</button>>
		</div>
	</div>
<</widget>>

<<widget "mirrorhairOptions">>
	<<set _hairOptions to {}>>
	<<run setup.hairstyles[_args[0]].forEach(style => {
		if (!V.shopClothingFilter.active || !V.shopClothingFilter.traits.length || style.type.find(type => V.shopClothingFilter.traits.includes(type))) T.hairOptions[style.name] = style.variable;
	})>>
	<<set _pageMax to Math.ceil(Object.keys(_hairOptions).length / _perPage)>>

	<<run Object.keys(_hairOptions).forEach((key, index) => {
	if (!between(index, T.perPage * (T.page - 1), (T.perPage * T.page) - 1)) {
			delete T.hairOptions[key];
		}
	})>>
<</widget>>

<<widget "mirrorhairdisplayLinks">>
	<div class="tab">
		<span @class="_args[0] is 'hair' ? 'tab-selected' : 'tab'">
			<<button "Sides">>
				<<replace "#hairContainer">>
					<div class="containerHeader" class="no-numberify">
						<<mirrorhairdisplayLinks "hair">>
					</div>
					<<mirrorhairdisplay "$hairtype" "sides">>
				<</replace>>
			<</button>>
		</span>
	</div>
	<div class="tab">
		<span @class="_args[0] is 'fringe' ? 'tab-selected' : ''">
			<<button "Fringe">>
				<<replace "#hairContainer">>
					<div class="containerHeader" class="no-numberify">
						<<mirrorhairdisplayLinks "fringe">>
					</div>
					<<mirrorhairdisplay "$fringetype" "fringe">>
				<</replace>>
			<</button>>
		</span>
	</div>
	<div class="tab">
		<span @class="_args[0] is 'style' ? 'tab-selected' : ''">
			<<button "Save/Load">>
				<<replace "#hairContainer">>
					<div class="containerHeader" class="no-numberify">
						<<mirrorhairdisplayLinks "style">>
					</div>
					<<mirrorhairdisplaySave>>
				<</replace>>
			<</button>>
			<div id="hairContainerSave" class="no-numberify">
			</div>
		</span>
	</div>
	<div class="tab">
		<span @class="_args[0] is 'filter' ? 'tab-selected' : ''">
			<<button "Filters">>
				<<replace "#hairContainer">>
					<div class="containerHeader" class="no-numberify">
						<<mirrorhairdisplayLinks "filter">>
					</div>
					<<mirrorhairdisplayFilter>>
				<</replace>>
			<</button>>
		</span>
	</div>
<</widget>>

<<widget "mirrorhairdisplayElements">>
	<div id="hairGridSides" class="no-numberify hairGrid">
		<<for _label, _hairName range _args[0]>>
			<<capture _hairCategory, _hairName>>
				<div @id="'hairGrid-' + _hairCategory.replace('$','') + '-' + _hairName.replace(/ /g,'')" @class="'gridItem' + (_hairName is V[_hairCategory.replace('$','')] ? ' selectedHair' : '')" @onclick="`wikifier('mirrorhairdisplayClick', '${T.hairCategory.replace('$','')}', '${T.hairName.replace(/ /g,'_')}');`">
					<<if $options.images is 1 and $showMannequins is 1>>
						<<selectmodel "main">>
						<<set _modeloptions.tanningEnabled to false>>
						<<set _modeloptions.skin_type = Skin.color.natural>>
						<<set _modeloptions.skin_tone = Skin.color.tan>>
						<<set _modeloptions.freckles = $player.freckles == true and $makeup.concealer != 1>>
						<<set _modeloptions.mouth to 'neutral'>>
						<<set _modeloptions.facevariant = $facevariant>>
						<<set _modeloptions.left_eye = $makeup.eyelenses.left != 0 ? $makeup.eyelenses.left : $leftEyeColour>>
						<<set _modeloptions.right_eye = $makeup.eyelenses.right != 0 ? $makeup.eyelenses.right : $rightEyeColour>>
						<<set _modeloptions.hair_colour = $haircolour>>
						<<set _modeloptions.hair_fringe_colour = $hairfringecolour>>
						<<set _modeloptions.hair_fringe_colour_gradient = $hairFringeColourGradient>>
						<<set _modeloptions.hair_fringe_colour_style = $hairFringeColourStyle>>
						<<set _modeloptions.hair_colour_gradient = $hairColourGradient>>
						<<set _modeloptions.hair_colour_style = $hairColourStyle>>
						<<set _modeloptions.hair_sides_length to $hairlengthstage>>
						<<set _modeloptions.hair_sides_position to $hairposition>>
						<<set _modeloptions.hair_fringe_length to $fringelengthstage>>
						<<if _hairCategory is "$hairtype">>
							<<set _modeloptions.hair_sides_type to _hairName>>
							<<set _modeloptions.hair_fringe_type to $fringetype>>
						<<else>>
							<<set _modeloptions.hair_fringe_type to _hairName>>
							<<set _modeloptions.hair_sides_type to $hairtype>>
						<</if>>
						<<set _modeloptions.ears_position to $earsposition>>
						<<rendermodel "hairstyleMannequin">>
						<br>
					<</if>>
					<<print toTitleCase(_label)>>
				</div>
			<</capture>>
		<</for>>
	</div>
<</widget>>

<<widget "mirrorhairdisplayClick">>
	<<if _args[0] and _args[1]>>
		<<if Object.values(_hairOptions).includes(V[_args[0]])>>
			<<set _id to "#hairGrid-" + _args[0] + "-" + V[_args[0]].replace(/ /g,"")>>
			<<removeclass _id "selectedHair">>
		<</if>>
		<<set V[_args[0]] to _args[1].replace(/_/g," ")>>
		<<set _id2 to "#hairGrid-" + _args[0] + "-" + _args[1].replace(/_/g,"")>>
		<<set $ruffledisable to "f">>
		<<addclass _id2 "selectedHair">>
		<<updatesidebarimg>>
		<<replace #hairDescription>><<hairDescription>><</replace>>
		<<replace #hairgelLinks>><<hairgelLinks>><</replace>>
	<</if>>
<</widget>>

<<widget "mirrorhairdisplaySave">>
	<div id="hairContainerHairstyle">
		<<mirrorHairSaveOptions>>
	</div>
	<div id="hairContainerSave" class="no-numberify">
		<<mirrorHairSave>>
	</div>
<</widget>>

<<widget "mirrorHairSaveOptions">>
		<<if !$savedHairStyles>>
			<<set $savedHairStyles to {
				Default: { hairtype:$hairtype, fringetype:$fringetype, hairposition:$hairposition }
			}>>
		<</if>>
		<div class="no-numberify saveHair">
		<span class="bold">Select a hairstyle:</span>
			<hr style="border:none;margin:.25em 0">
			<<set _savedHairStylesKeys to Object.keys($savedHairStyles)>>
			<<if _savedHairStylesKeys.length gt 0>>
				<<listbox '_selectedSavedHairStyle'>>
					<<optionsfrom _savedHairStylesKeys>>
				<</listbox>>
			<</if>>
			<br>
		</div>
		<div class="no-numberify saveHair">
			<span class="bold" style="margin:.25em 0">Create a new hairstyle:</span>
			<hr style="border:none;margin:.25em 0">
			<label>Name: <<textbox "_hairStyleName" "">></label>
			<mouse class="tooltip linkBlue"> (?)<span>Saves your current hairstyle, so it may be worn later. Duplicate names will overwrite existing styles.</span></mouse>
			<span id="textbox-error"></span>
		</div>
<</widget>>


<<widget "mirrorhairdisplayFilter">>
	<div id="hairContainerTraits" class="no-numberify">
		<<mirrorHairTraitList>>
	</div>
	<div id="hairContainerFilter">
		<<mirrorhairTraits>>
	</div>
<</widget>>

<<widget "mirrorHairTraitList">>
	<<set _shopLocation to "mirrorhair">>
	<div class="hairGridTraits">
		<div class="traitCategory">
			<<set _textureTraits to ["curly", "sleek", "wavy", "textured"]>>
			<span class="gold" style="padding-left:5px">Texture:</span>
				<<for _trait range _textureTraits.sort()>>
					<<silently>><< _trait>><</silently>>
					<<set _traitObj to setup.shopDetails[_trait]>>
					<div class="filters-trait-row">
						<label>
							<<set _checked = $shopClothingFilter.traits.includes(_trait) ? 'checked="checked"' : ''>>
							<<clothingtrait _trait 'display_normal'>>
							<<print '<input type="checkbox" @id="_trait" @value="_trait" ' + _checked + ' onclick="window.shopClothingFilterToggleTrait(this.value)">'>>
							<<if !_traitObj.desc>>
								<<print _traitObj.name>>
							<<else>>
								<mouse class = "tooltip-small">
									<<print _traitObj.name>>
									<span class="black"><<print _traitObj.desc>></span>
								</mouse>
							<</if>>
						</label>
					</div>
				<</for>>
		</div>
		<div class="traitCategory">
			<span class="gold" style="padding-left:5px">Style:</span>
			<<set _styleTraits to ["braids", "buns", "pigtails", "ponytail"]>>
				<<for _trait range _styleTraits.sort()>>
					<<silently>><< _trait>><</silently>>
					<<set _traitObj to setup.shopDetails[_trait]>>
					<div class="filters-trait-row">
						<label>
							<<set _checked = $shopClothingFilter.traits.includes(_trait) ? 'checked="checked"' : ''>>
							<<clothingtrait _trait 'display_normal'>>
							<<print '<input type="checkbox" @id="_trait" @value="_trait" ' + _checked + ' onclick="window.shopClothingFilterToggleTrait(this.value)">'>>
							<<if !_traitObj.desc>>
								<<print _traitObj.name>>
							<<else>>
								<mouse class = "tooltip-small">
									<<print _traitObj.name>>
									<span class="black"><<print _traitObj.desc>></span>
								</mouse>
							<</if>>
						</label>
					</div>
				<</for>>
		</div>
		<div class="traitCategory">
			<span class="gold" style="padding-left:5px">Other</span>
			<<set _otherTraits to ["loose","short"]>>
				<<for _trait range _otherTraits.sort()>>
					<<silently>><< _trait>><</silently>>
					<<set _traitObj to setup.shopDetails[_trait]>>
					<div class="filters-trait-row">
						<label>
							<<set _checked = $shopClothingFilter.traits.includes(_trait) ? 'checked="checked"' : ''>>
							<<clothingtrait _trait 'display_normal'>>
							<<print '<input type="checkbox" @id="_trait" @value="_trait" ' + _checked + ' onclick="window.shopClothingFilterToggleTrait(this.value)">'>>
							<<if !_traitObj.desc>>
								<<print _traitObj.name>>
							<<else>>
								<mouse class = "tooltip-small">
									<<print _traitObj.name>>
									<span class="black"><<print _traitObj.desc>></span>
								</mouse>
							<</if>>
						</label>
					</div>
				<</for>>
		</div>
	</div>
<</widget>>

<<widget "mirrorHairSave">>
	<div class="hairContainerSave">
	<<if _savedHairStylesKeys.length gt 0>>
	<div class="tab">
		<<button '<span class="fa-icon fa-check"></span> Wear'>>
			<<set $hairtype to $savedHairStyles[_selectedSavedHairStyle].hairtype>>
			<<set $fringetype to $savedHairStyles[_selectedSavedHairStyle].fringetype>>
			<<set $hairposition to $savedHairStyles[_selectedSavedHairStyle].hairposition>>
			<<set $ruffledisable to "f">>
			<<updatesidebarimg>>
		<</button>>
		<<button '<span class="fa-icon fa-overwrite"></span> Overwrite'>>
			<<set $savedHairStyles[_selectedSavedHairStyle].hairtype to $hairtype>>
			<<set $savedHairStyles[_selectedSavedHairStyle].fringetype to $fringetype>>
			<<set $savedHairStyles[_selectedSavedHairStyle].hairposition to $hairposition>>
			<<updatesidebarimg>>
		<</button>>
		<<button '<span class="fa-icon fa-delete"></span> Delete'>>
			<<if _selectedSavedHairStyle isnot "Default">>
				<<run $outfit.forEach((o) => {
					if(o.hairStyle === T.selectedSavedHairStyle){
						o.hairStyle = undefined;
					}
				})>>
				<<run delete $savedHairStyles[_selectedSavedHairStyle]>>
				<<updatesidebarimg>>
				<<replace #hairContainerHairstyle>><<mirrorHairSaveOptions>><</replace>>
			<</if>>
		<</button>>
		<<button '<span class="fa-icon fa-save"></span> Save'>>
			<<if _hairStyleName is "">>
				<<replace "#textbox-error">><br> <span class="red">Please enter a name.</span><</replace>>
			<<else>>
				<<replace "#textbox-error">><</replace>>
				<<set _hairStyleName to _hairStyleName.replace(/[^a-zA-Z\u4e00-\u9fa50-9_-]+/g,"").substring(0,30)>>
				<<set $savedHairStyles[_hairStyleName] to { hairtype:$hairtype, fringetype:$fringetype, hairposition:$hairposition }>>
				<<replace #hairContainerHairstyle>><<mirrorHairSaveOptions>><</replace>>
			<</if>>
		<</button>>
	</div>
	<<else>>
	<div class="tab">
		<<button '<span class="fa-icon fa-save"></span> Save'>>
			<<if _hairStyleName is "">>
				<<replace "#textbox-error">><br> <span class="red">Please enter a name.</span><</replace>>
			<<else>>
				<<replace "#textbox-error">><</replace>>
				<<set _hairStyleName to _hairStyleName.replace(/[^a-zA-Z\u4e00-\u9fa50-9_-]+/g,"").substring(0,30)>>
				<<set $savedHairStyles[_hairStyleName] to { hairtype:$hairtype, fringetype:$fringetype, hairposition:$hairposition }>>
				<<replace #hairContainerHairstyle>><<mirrorHairSaveOptions>><</replace>>
			<</if>>
		<</button>>
	</div>
	<</if>>
	</div>
<</widget>>


<<widget "mirrorMakeupPart">>
	<<set _itemType = _args[0]>>

	<<set _items = $makeup.owned[_itemType].filter(x => x.count > 0)>>
	<<if $makeup.owned[_itemType].length == 0>>
		<<cosmeticsicon _itemType>> You don't own any _itemType.
	<<elseif _items.length == 0>>
		You ran out of _itemType.
		<br>
	<</if>>
	<<if _items.length != 0 or $makeup[_itemType] != 0>>
		<<cosmeticsicon _itemType>>
		<span class="gold bold"><<= _itemType.toUpperFirst()>>:</span>
		<<if $makeup[_itemType] != 0>>
			<<capture _itemType>>
			<span class="no-numberify">
				<<link "Remove">>
					<<if _itemType is "eyelenses">>
						<!-- A safety check for $makeup.eyelenses -->
						<<set $makeup.eyelenses to { left: 0, right: 0 }>>
					<<else>>
						<<set $makeup[_itemType] to 0>>
					<</if>>
					<<if _itemType == 'mascara'>>
						<<set $makeup.mascara_running = 0>>
					<</if>>
					<<run Engine.show()>>
				<</link>>
			</span>
			<</capture>>
		<</if>>
		<div class="makeupList no-numberify capitalize">
			<<for _i, _item range _items>>
				<span @class="$makeup[_itemType] == _item.colour ? 'makeupWorn' : 'makeupItem'">
					<<capture _item, _itemType>>
						<<set _name to
						`_item.colour <span @class="_itemType+'-'+_item.colour.replace(/ /g, '-')"><span class="colour-sample"></span></span>
						× _item.count`>>
						<<button _name>>
							<<handheldon>>
							<<if _itemType is "lipstick">>
								<<set _colour to _item.colour is "dark red" ? "jewel red" : _item.colour is "orange" ? "tangerine" : _item.colour>>
								<<wearProp _itemType _colour>>
							<<else>>
								<<wearProp _itemType>>
							<</if>>
							<<if $makeup[_itemType] !== _item.colour>>
								<<set $makeup[_itemType] = _item.colour>>
								<<set _item.count -= 1>>
								<<if _itemType == 'mascara'>>
									<<set $makeup.mascara_running = 0>>
								<</if>>
								<<run Engine.show()>>
							<</if>>
						<</button>>
					<</capture>>
				</span>
			<</for>>
		</div>
	<</if>>
<</widget>>

<<widget "mirrorMakeup">>
	<<mirroricon>><<link "뒤로">><<replace #mirror>><<mirrorMenu>><</replace>><<numberify "#passages > .passage">><<unset $mirrorMenu>><</link>>
	<br><br>
	<div class="settingsGrid">
		<div class="settingsHeader">Makeup</div>
		<<set _makeup to []>>
		<<if $makeup.lipstick isnot 0>>
			<<run _makeup.push($makeup.lipstick + " lipstick")>>
		<</if>>
		<<if $makeup.eyeshadow isnot 0>>
			<<run _makeup.push($makeup.eyeshadow + " eyeshadow")>>
		<</if>>
		<<if $makeup.blusher isnot 0>>
			<<run _makeup.push($makeup.blusher + " blusher")>>
		<</if>>
		<<if $makeup.mascara isnot 0>>
			<<run _makeup.push($makeup.mascara + " mascara")>>
		<</if>>
		<<if $makeup.concealer is 1>>
			<<run _makeup.push("concealer")>>
		<</if>>
		<<set _makeupNames to ["lipstick","eyeshadow","mascara","blusher","browscolour","eyelenses"]>>
		<<set _makeupData to ["lipstick","eyeshadow","mascara","blusher","hairdye","eyelenses"]>>
		<<set _ownsMakeup to _makeupData.some(item => $makeup.owned[item].some(colour => colour.count > 0))>>
		<<set _removableMakeup to _makeup.length gt 1 or (_makeup.length is 1 and _makeup[0] isnot "concealer")>>

		<div class="settingsToggleItemWide">
			<<if _makeup.length gt 0>>
				You are wearing <<=_makeup.reduce( (a, b, i, array) => a + ( i < array.length - 1 ? ', ' : (array.length > 2 ? ', and ' : ' and ') ) + b)>>.
			<<else>>
				You are not wearing any makeup.
			<</if>>

			<<if _ownsMakeup or _makeup.length gt 0 or $player.freckles == true>>
				<br><br>
				Makeup:
			<</if>>
			<<if _removableMakeup>>
				<<link [[Remove all|$passage]]>>
					<<set $makeup.lipstick to 0>>
					<<set $makeup.eyeshadow to 0>>
					<<set $makeup.mascara to 0>>
					<<set $makeup.blusher to 0>>
					<<set $makeup.eyelenses to { left: 0, right: 0 }>>
					<<set $makeup.mascara_running to 0>>
				<</link>>
				<<if _makeup.includes("concealer")>>
					<mouse class="tooltip linkBlue">(?)<span>Will not remove concealer.</span></mouse>
				<</if>>
				|
			<</if>>

			<<if _ownsMakeup>>
				<<link [[Randomise|$passage]]>>
					<<for _i to 0; _i lt _makeupNames.length; _i++>>
						<<set _ownedMakeup to $makeup.owned[_makeupData[_i]]>>
						<<if _makeupNames[_i] is "eyelenses">>
							<<set _rng to random(0, _ownedMakeup.length)>>
							<<set _lens to _rng is _ownedMakeup.length ? 0 : _ownedMakeup[_rng]>>
							<<set $makeup.eyelenses to { left: _lens, right: _lens }>>
						<<else>>
							<<set _rngset to []>>
							<<for _label, _value range _ownedMakeup>>
								<<if _value.count gt 0>>
									<<run _rngset.push(_label)>>
								<</if>>
							<</for>>
							<<run _rngset.push(_ownedMakeup.length)>>
							<<set _rng to _rngset[random(0, _rngset.length - 1)]>>
							<<if _rng is _ownedMakeup.length and _makeupNames[_i] is "browscolour">>
								/*Do Nothing*/
							<<elseif _rng is _ownedMakeup.length>>
								<<set $makeup[_makeupNames[_i]] to 0>>
							<<elseif _ownedMakeup[_rng].count gt 0 and $makeup[_makeupNames[_i]] isnot _ownedMakeup[_rng].colour>>
								<<set $makeup[_makeupNames[_i]] to _ownedMakeup[_rng].colour>>
								<<set _ownedMakeup[_rng].count-->>
							<</if>>
						<</if>>
					<</for>>
				<</link>>
			<</if>>
			/* CONCEALER */
			<<if $player.freckles == true>>
				<<if _ownsMakeup>>|<</if>>
				<<if $makeup.concealer == 0>>
					<<link "Hide freckles with concealer">>
						<<set $makeup.concealer = 1>>
						<<run Engine.show()>>
					<</link>>
				<<else>>
					<<link "Remove concealer">>
						<<set $makeup.concealer = 0>>
						<<run Engine.show()>>
					<</link>>
				<</if>>
			<</if>>
			<<if $makeup.presets is undefined>>
				<<set $makeup.presets to {}>>
			<</if>>
			<<if Object.keys($makeup.presets).length gt 0>>
				<br>
				Presets:
				<<for _label, _value range $makeup.presets>>
					<<capture _label>>
						<<link _label>>
							<<replace "#makeupPresets">>
								<<makeupPresets _label>>
							<</replace>>
						<</link>>
						<<if _label != Object.keys(V.makeup.presets).slice(-1)[0]>>|<</if>>
					<</capture>>
				<</for>>
				<div id="makeupPresets"></div>
			<</if>>
		</div>
		<div class="settingsToggleItem">
			<<mirrorMakeupPart "lipstick">>
		</div>
		<div class="settingsToggleItem">
			<<mirrorMakeupPart "eyeshadow">>
		</div>
		<div class="settingsToggleItem">
			<<mirrorMakeupPart "mascara">>
		</div>
		<div class="settingsToggleItem">
			<<mirrorMakeupPart "blusher">>
		</div>
		<div class="settingsToggleItemWide">
			<span class="gold bold">New Makeup Preset</span>
			<br>
			Saves the makeup you currently have equipped.
			<br>
			<<textbox "_newPresetName" "">>
			<br>
			<<link [[Save preset|$passage]]>>
				<<set _newPresetName to _newPresetName.replace(/[^a-zA-Z\u4e00-\u9fa5 0-9]+/g,"")>>
				<<set $makeup.presets[_newPresetName] to {
					lipstick:clone($makeup.lipstick),
					eyeshadow:clone($makeup.eyeshadow),
					mascara:clone($makeup.mascara),
					blusher:clone($makeup.blusher),
					browscolour:clone($makeup.browscolour),
					eyelenses:clone($makeup.eyelenses),
				}>>
			<</link>>
		</div>
		<<if !$simpleMirror>>
			<div class="settingsToggleItemWide">
				<<cosmeticsicon "contacts">>
				<<if $makeup.owned.eyelenses.length == 0 and $makeup.owned.custom_eyelenses.length == 0>>
					You don't own any contact lenses.
				<<else>>
					<span class="gold bold">Contact Lenses:</span>
					<<if $makeup.eyelenses.left != 0 || $makeup.eyelenses.right != 0>>
						<span class="no-numberify">
							<<link "Remove">>
								<<set $makeup.eyelenses = { left: 0, right: 0 }>>
								<<run Engine.show()>>
							<</link>>
						</span>
						<br>
						You are wearing
						<<if $makeup.eyelenses.left is $makeup.eyelenses.right>>
							<<= $makeup.eyelenses.left>> contacts.
						<<elseif $makeup.eyelenses.left != 0 and $makeup.eyelenses.right != 0>>
							<<= $makeup.eyelenses.left>> contacts in your left eye and <<= $makeup.eyelenses.right>> contacts in your right eye.
						<<else>>
							<<set _lens to $makeup.eyelenses.left != 0 ? $makeup.eyelenses.left : $makeup.eyelenses.right>>
							<<set _eye to $makeup.eyelenses.left != 0 ? "left" : "right">>
							<<= _lens>> contacts in your <<= _eye>> eye. Your <<= _eye is "left" ? "right" : "left">> eye is your natural <<= _eye is "left" ? $rightEyeColour : $leftEyeColour>> colour.
						<</if>>
					<<else>>
						<br>
						You are not wearing any contact lenses.
					<</if>>
					<br><br>

					Put contacts in:
					<label><<radiobutton "_contact_eye_selected" "Both" checked>> Both eyes</label> |
					<label><<radiobutton "_contact_eye_selected" "Left eye">> Left eye</label> |
					<label><<radiobutton "_contact_eye_selected" "Right eye">> Right eye</label>
					<br>
					<div class="makeupList no-numberify capitalize">
						<<for _i, _colour range $makeup.owned.eyelenses>>
							<<switch _contact_eye_selected>>
								<<default>><<set _eye to "left">>
							<</switch>>
							<span class="makeupItem">
								<<capture _colour>>
									<<set _contactName to
									`_colour <span @class="'eye-'+_colour.replace(/ /g, '-')"><span class="colour-sample bgcolour-eyes left-"></span></span>`>>

									<<button _contactName>>
										<<handheldon 1>>
										<<if _contact_eye_selected == "Both">>
											<<set $makeup.eyelenses = { left: _colour, right: _colour }>>
										<<elseif _contact_eye_selected == "Left eye">>
											<<set $makeup.eyelenses.left = _colour>>
										<<elseif _contact_eye_selected == "Right eye">>
											<<set $makeup.eyelenses.right = _colour>>
										<</if>>
										<<run Engine.show()>>
									<</button>>
								<</capture>>
							</span>
						<</for>>
						/* I wish a fiery death on whoever made the custom contacts */
						<<for _i = 0; _i < $makeup.owned.custom_eyelenses.length; _i++>>
							<<run _colour = $makeup.owned.custom_eyelenses[_i]>>
							<<for _e = 0; _e < $custom_eyecolours.length; _e++>>
								<<if $custom_eyecolours[_e].variable == $makeup.owned.custom_eyelenses[_i]>>
									<<set _background_colour to clone($custom_eyecolours[_e].canvasfilter.blend)>>
								<</if>>
							<</for>>
							<span class="makeupItem">
								<<capture _colour _background_colour>>
									<<set _colourSpaced to window.colorNameTranslate(_colour, "spaced name")>>
									<<set _customName to
									`_colourSpaced [C] <span class="eye-custom"><span @style="'background:'+_background_colour" class="colour-sample"></span></span>`>>

									<<button _customName>>
										<<if _contact_eye_selected == "Both">>
											<<set $makeup.eyelenses = { left:_colour, right:_colour }>>
										<<elseif _contact_eye_selected == "Left eye">>
											<<set $makeup.eyelenses.left = _colour>>
										<<elseif _contact_eye_selected == "Right eye">>
											<<set $makeup.eyelenses.right = _colour>>
										<</if>>
										<<run Engine.show()>>
									<</button>>
								<</capture>>
							</span>
						<</for>>

					</div>
				<</if>>
			</div>
			/* WHY IS THIS IN THE BEDROOM AND NOT THE BATHROOM WITH THE PUBIC HAIR DYE? WHY IS IT SAVED WITH MAKEUP PRESETS? */
			<div class="settingsToggleItemWide">
				<<cosmeticsicon "dyes">>
				<<set _dyes = $makeup.owned.hairdye.filter(x => x.count > 0)>>
				<<if _dyes.length == 0>>
					You have no hair dye to dye your eyebrows with.
				<<else>>
					<span class="gold bold">Eyebrow Colour:</span>
					<br>
					<<if $mirror_eyebrow_dye is true>>
						<<handheldon 1>>
						<<wearProp "hairdye">>
						<<unset $mirror_eyebrow_dye>>
						You open up the box with <<= setup.colours.hair_map[$browsDyeOption].name>> dye and prepare the mixture. Using a small brush, you carefully apply the dye to your eyebrows. You wait several minutes for the dye to set and hope you didn't mess up anything.
						<<set $makeup.owned.hairdye.find(x => x.colour == $browsDyeOption).count -= 1>><<set $makeup.browscolour = $browsDyeOption>><<unset $browsDyeOption>>
						<hr>
					<</if>>

					<<if $makeup.browscolour != 0>>
						Your brows are coloured with <<hairmapcolourtext $makeup.browscolour>> hair dye. Visit a hairdresser to restore them to their natural <<hairmapcolourtext $naturalhaircolour>> colour.
					<<else>>
						Your brows are their natural <<hairmapcolourtext $naturalhaircolour>> colour.
					<</if>>
					<br><br>
					Dying your eyebrows will take <span class="gold">0:15</span> minutes.
					<br>
					<div class="makeupList no-numberify capitalize">
						<<for _i to 0; _i lt _dyes.length; _i++>>
							<<if $makeup.browscolour is _dyes[_i].colour or $naturalhaircolour is _dyes[_i].colour>>
								<<continue>>
							<</if>>
							<<set _displayName = (_dyes[_i].colour in setup.colours.hair_map ? setup.colours.hair_map[_dyes[_i].colour].name : _dyes[_i].colour.charAt(0).toUpperCase() + _dyes[_i].colour.slice(1)) + " ×" + _dyes[_i].count + " ">>
							<<set _dyeName to _displayName + `<span @class="'hair-' + _dyes[_i].colour.replace(/ /g, '-')"><span class="colour-sample bgcolour-hair colour-hair"></span></span>`>>
							<<capture _dyes, _i>>
								<<button _dyeName>>
									<<set $mirror_eyebrow_dye to true>><<pass 15>>
									<<set $browsDyeOption to _dyes[_i].colour>>
									<<run Engine.show()>>
								<</button>>
							<</capture>>
						<</for>>
					</div>
				<</if>>
			</div>
		<</if>>
	</div>
<</widget>>

<<widget "makeupPresets">>
	<<set _presetChosen to $makeup.presets[_args[0]]>>
	<hr>
	Preset: <<print _args[0]>>
	<br>
	<<for $_label, $_value range _presetChosen>>
		<<switch $_label>>
			<<case "browscolour">>
				Eyebrow Dye: <<makeupPresetsItem "hairdye" $_value>>
			<<case "lipstick">>
				Lipstick: <<makeupPresetsItem $_label $_value>>
			<<case "eyeshadow">>
				Eyeshadow: <<makeupPresetsItem $_label $_value>>
			<<case "mascara">>
				Mascara: <<makeupPresetsItem $_label $_value>>
			<<case "blusher">>
				Blusher: <<makeupPresetsItem $_label $_value>>
			<<case "eyelenses">>
				Contact Lenses: <<makeupPresetsItem $_label $_value>>
		<</switch>>
		<br>
	<</for>>
	<br>
	<<link [[Apply preset makeup|$passage]]>>
		<<for _makeupName range _makeupNames>>
			<<set _preset to _presetChosen[_makeupName]>>
			<<if _makeupName is "eyelenses">>
				<<if _preset.left is 0 and _preset.right is 0>>
					<<set $makeup.eyelenses to { left:0, right:0 }>>
				<<elseif $makeup.owned.eyelenses.includes(_preset.left) and $makeup.owned.eyelenses.includes(_preset.right)>>
					<<set $makeup.eyelenses to _preset>>
				<<elseif $makeup.owned.custom_eyelenses.includes(_preset.left) and $makeup.owned.custom_eyelenses.includes(_preset.right)>>
					<<set $makeup.eyelenses to _preset>>
				<</if>>
			<<elseif _preset is 0 and _makeupName is "hairdye">>
				/*Do Nothing*/
			<<elseif _preset is 0>>
				<<set $makeup[_makeupName] to 0>>
			<<else>>
				<<set _makeupName2 to (_makeupName is "browscolour" ? "hairdye" : _makeupName)>>
				<<set _target to $makeup.owned[_makeupName2].find(invMakeup => invMakeup.colour is _preset and invMakeup.colour isnot $makeup[_makeupName] and invMakeup.count gt 0)>>
				<<if _target>>
					<<set $makeup[_makeupName] to clone(_target.colour)>>
					<<set _target.count-->>
				<</if>>
			<</if>>
		<</for>>
	<</link>> |
	<<link [[Delete preset|$passage]]>>
		<<run delete $makeup.presets[_args[0]]>>
	<</link>>
<</widget>>

<<widget "makeupPresetsItem">>
	<<if _args[0] isnot undefined and _args[1] isnot undefined>>
		<<if _args[1] is 0 and _args[0] is "hairdye">>
			<span class="green">Natural</span>
		<<elseif _args[1] is 0>>
			None
		<<else>>
			<<if _args[0] is "eyelenses">>
				<<if _args[1].left == 0 && _args[1].right == 0>>
					None
				<<elseif _args[1].left == _args[1].right>>
					<span class="green"><<print _args[1].left.toUpperFirst()>> (Owned)</span>
				<<else>>
					<<if _args[1].left == 0>>
						<<set _args[1].left to "None">>
					<</if>>
					<<if _args[1].right == 0>>
						<<set _args[1].right to "None">>
					<</if>>
					<span class="green"><<print _args[1].left.toUpperFirst() + " (Left), " + _args[1].right.toUpperFirst()+" (Right)">></span>
				<</if>>
			<<else>>
				<<for $_i to 0; $_i lt $makeup.owned[_args[0]].length; $_i++>>
					<<if $makeup.owned[_args[0]][$_i].colour is _args[1]>>
						<<if $makeup.owned[_args[0]][$_i].count gt 0>>
							<span class="green"><<print _args[1].toUpperFirst()>> (<<print "×"+$makeup.owned[_args[0]][$_i].count>>)</span>
						<<else>>
							<span class="red"><<print _args[1].toUpperFirst()>> (× 0)</span>
						<</if>>
						<<break>>
					<</if>>
				<</for>>
			<</if>>
		<</if>>
	<</if>>
<</widget>>

<<widget "browsColourPreview">>
	<span id="browsColourPreview">
	<<if $browsDyeOption isnot "noChange">>
		<span @class="'hair-' + $browsDyeOption.replace(/ /g, '-')">
			<span class="colour-sample bgcolour-hair colour-hair"></span>
		</span>
		<br><<link [[Dye eyebrows (0:15)|$passage]]>><<set $mirror_eyebrow_dye to true>><<pass 15>><</link>>
	<</if>>
	</span>
<</widget>>

<<widget "mirrorTransformation">>
	<<mirroricon>><<link "뒤로">><<replace #mirror>><<mirrorMenu>><</replace>><<numberify "#passages > .passage">><<unset $mirrorMenu>><</link>>
	<<set _angel to $transformationParts.angel>>
	<<set _fallen to $transformationParts.fallenAngel>>
	<<set _demon to $transformationParts.demon>>
	<<set _cat to $transformationParts.cat>>
	<<set _cow to $transformationParts.cow>>
	<<set _wolf to $transformationParts.wolf>>
	<<set _bird to $transformationParts.bird>>
	<<set _fox to $transformationParts.fox>>
	<<set _traits to $transformationParts.traits>>
	<<set _divine to ["angel", "fallenangel", "demon"].find(tf => V[tf] > 1)>>
	<<set _animal to ["cat", "cow", "wolfgirl", "harpy", "fox"].find(tf => V[tf] > 1)>>
	<div class="settingsGrid">
		<div class="settingsHeader">Transformations</div>
		<div class="settingsToggleItemWide">
			<<if $hypnosis_traits.peace gte 1 and $settings.hypnosisEnabled>>
				Hiding parts of your inner self lowers your attractiveness and allure. <span class="forest-green">You are at peace with your inner self, and will incur no penalty.</span>
			<<else>>
				Hiding parts of your Inner Self lowers your attractiveness and allure, but will also slowly increase your Trauma over time. <<if ["wolfgirl", "harpy", "fox"].includes(_animal)>>Extra bodyhair (pubes, puts) can be hidden without affecting your attractiveness or incurring Trauma.<</if>> If your Trauma gets too high, you will be unable to hide.
			<</if>>
		</div>
		<<if _divine>>
			<div @class="_animal ? 'settingsToggleItem' : 'settingsToggleItemWide'">
				<<tficon _divine>> <span class="gold bold">Divine: <<= _divine is "fallenangel" ? "Fallen Angel" : _divine.toUpperFirst()>></span>
				<<if $angel gt 1>>
					<<if _angel.halo isnot "disabled">>
						<div class='tf-part-item'>
							Halo:
							<<listbox "_angel.halo" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
								<<option "Celestial" "celestial">>
								<<option "Traditional" "traditional">>
							<</listbox>>
						</div>
					<</if>>
					<<if _angel.wings isnot "disabled">>
						<div class='tf-part-item'>
							Wings:
							<<listbox "_angel.wings" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
								<<option "Cherub" "cherub">>
								<<option "Classic" "classic">>
							<</listbox>>
						</div>
					<</if>>
				<<elseif $fallenangel gt 1>>
					<<if _fallen.halo isnot "disabled">>
						<div class='tf-part-item'>
							Halo:
							<<if $fallenangel gte 4>>
								<<listbox "_fallen.halo" autoselect>>
									<<option "Hide" "hidden">>
									<<option "Default" "default">>
									<<option "Celestial" "celestial">>
									<<option "Dark Celestial" "celestial-black">>
									<<option "Blue Celestial" "celestial-fallenplus">>
									<<option "Traditional" "traditional">>
								<</listbox>>
							<<else>>
								<<listbox "_fallen.halo" autoselect>>
									<<option "Hide" "hidden">>
									<<option "Default" "default">>
									<<option "Celestial" "celestial">>
									<<option "Dark Celestial" "celestial-black">>
									<<option "Traditional" "traditional">>
								<</listbox>>
							<</if>>
						</div>
					<</if>>
					<<if _fallen.wings isnot "disabled">>
						<div class='tf-part-item'>
							Wings:
							<<if $fallenangel gte 4>>
								<<listbox "_fallen.wings" autoselect>>
									<<option "Hide" "hidden">>
									<<option "Default" "default">>
									<<option "Torn" "torn">>
									<<option "Cherub" "cherub">>
									<<option "Dark Cherub" "cherub-black">>
									<<option "Feathered Cherub" "cherub-fallenplus">>
									<<option "Feathered" "fallenplus">>
									<<option "Classic Feathered" "classicfallenplus">>
									<<option "Classic" "classic">>
								<</listbox>>
							<<else>>
								<<listbox "_fallen.wings" autoselect>>
									<<option "Hide" "hidden">>
									<<option "Default" "default">>
									<<option "Torn" "torn">>
									<<option "Cherub" "cherub">>
									<<option "Dark Cherub" "cherub-black">>
									<<option "Classic" "classic">>
								<</listbox>>
							<</if>>
						</div>
					<</if>>
				<<elseif $demon gt 1>>
					<<if _demon.horns isnot "disabled">>
						<div class='tf-part-item'>
							Horns:
							<<listbox "_demon.horns" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
								<<option "Classic" "classic">>
								<<option "Succubus" "succubus">>
							<</listbox>>
							<<gencolourselector "_demon.horns_colour">>
						</div>
					<</if>>
					<<if _demon.wings isnot "disabled">>
						<div class='tf-part-item'>
							Wings:
							<<listbox "_demon.wings" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
								<<option "Imp" "imp">>
								<<option "Succubus" "succubus">>
							<</listbox>>
							<<gencolourselector "_demon.wings_colour">>
						</div>
					<</if>>
					<<if _demon.tail isnot "disabled">>
						<div class='tf-part-item'>
							Tail:
							<<listbox "_demon.tail" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
								<<option "Imp" "imp">>
								<<option "Classic" "classic">>
								<<option "Succubus" "succubus">>
							<</listbox>>
							<<gencolourselector "_demon.tail_colour">>
						</div>
					<</if>>
					<<if $demon gte 4>>
						<div class='tf-part-item'>
							<<if hasSexStat("exhibitionism", 6)>>
								Flaunting when exposed:
								<<listbox "_traits.flaunting" autoselect>>
									<<option "Hide" "hidden">>
									<<option "Default" "default">>
								<</listbox>>
								<<ind>>
							<<else>>
								<span class="black">Flaunting (requires higher exhibitionism):</span>
								<<listbox "_traits.flaunting" autoselect>>
									<<option "Hide" "hidden">>
								<</listbox>>
								<<ind>>
							<</if>>
						</div>
					<</if>>
				<</if>>
			</div>
		<</if>>

		<<if _animal>>
			<div @class="_divine ? 'settingsToggleItem' : 'settingsToggleItemWide'">
				<span class="gold bold"><<tficon _animal>>Animal: <<= _animal is "harpy" ? "Bird" : _animal is "wolfgirl" ? "Wolf" : _animal.toUpperFirst()>></span>
				<<if $cat gt 1>>
					<<if _cat.ears isnot "disabled">>
						<div class='tf-part-item'>
							Ears:
							<<listbox "_cat.ears" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _cat.tail isnot "disabled">>
						<div class='tf-part-item'>
							Tail:
							<<listbox "_cat.tail" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _cat.heterochromia isnot "disabled">>
						<div class='tf-part-item'>
							Heterochromia:
							<<listbox "_cat.heterochromia" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
				<</if>>
				<<if $cow gt 1>>
					<<if _cow.horns isnot "disabled">>
						<div class='tf-part-item'>
							Horns:
							<<listbox "_cow.horns" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _cow.ears isnot "disabled">>
						<div class='tf-part-item'>
							Ears:
							<<listbox "_cow.ears" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
								<<option "Spotted black" "spotted black">>
								<<option "Spotted brown" "spotted brown">>
							<</listbox>>
						</div>
					<</if>>
					<<if _cow.tail isnot "disabled">>
						<div class='tf-part-item'>
							Tail:
							<<listbox "_cow.tail" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
								<<option "Black" "black">>
							<</listbox>>
						</div>
					<</if>>
				<</if>>
				<<if $wolfgirl gt 1>>
					<<if _wolf.ears isnot "disabled">>
						<div class='tf-part-item'>
							Ears:
							<<listbox "_wolf.ears" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
								<<option "Feral" "feral">>
							<</listbox>>
						</div>
					<</if>>
					<<if _wolf.tail isnot "disabled">>
						<div class='tf-part-item'>
							Tail:
							<<listbox "_wolf.tail" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
								<<option "Feral" "feral">>
							<</listbox>>
						</div>
					<</if>>
					<<if _wolf.cheeks isnot "disabled">>
						<div class='tf-part-item'>
							Cheeks:
							<<listbox "_wolf.cheeks" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Feral" "feral">>
							<</listbox>>
						</div>
					<</if>>
					<<if _wolf.pubes isnot "disabled" and $settings.pubicHairEnabled>>
						<div class='tf-part-item'>
							Pubes:
							<<listbox "_wolf.pubes" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _wolf.pits isnot "disabled" and $settings.pubicHairEnabled>>
						<div class='tf-part-item'>
							Pits:
							<<listbox "_wolf.pits" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
				<</if>>
				<<if $harpy gt 1>>
					<<if _bird.eyes isnot "disabled">>
						<div class='tf-part-item'>
							Eyes:
							<<listbox "_bird.eyes" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _bird.malar isnot "disabled">>
						<div class='tf-part-item'>
							Malar Stripes:
							<<listbox "_bird.malar" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _bird.plumage isnot "disabled">>
						<div class='tf-part-item'>
							Plumage:
							<<listbox "_bird.plumage" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _bird.tail isnot "disabled">>
						<div class='tf-part-item'>
							Tail:
							<<listbox "_bird.tail" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _bird.wings isnot "disabled">>
						<div class='tf-part-item'>
							Wings:
							<<listbox "_bird.wings" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _bird.pubes isnot "disabled" and $settings.pubicHairEnabled>>
						<div class='tf-part-item'>
							Pubes:
							<<listbox "_bird.pubes" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
				<</if>>
				<<if $fox gt 1>>
					<<if _fox.ears isnot "disabled">>
						<div class='tf-part-item'>
							Ears:
							<<listbox "_fox.ears" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _fox.tail isnot "disabled">>
						<div class='tf-part-item'>
							Tail:
							<<listbox "_fox.tail" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<<if _fox.cheeks isnot "disabled">>
						<div class='tf-part-item'>
							Cheeks:
							<<listbox "_fox.cheeks" autoselect>>
								<<option "Hide" "hidden">>
								<<option "Default" "default">>
							<</listbox>>
						</div>
					<</if>>
					<br>
				<</if>>
				<<set $_chimeraOptions to {
					"demoncat_tail" : !["disabled", "hidden"].includesAny(_demon.tail, _cat.tail),
					"demoncow_tail" : !["disabled", "hidden"].includesAny(_demon.tail, _cow.tail),
					"demonwolf_tail" : !["disabled", "hidden"].includesAny(_demon.tail, _wolf.tail),
					"demonfox_tail" : !["disabled", "hidden"].includesAny(_demon.tail, _fox.tail),
					"demonfox_ears" : !["disabled", "hidden"].includesAny(_fox.ears) && V.demon >= 6,
					"demonharpy_wings" : !["disabled", "hidden"].includesAny(_demon.wings, _bird.wings),
					"angelharpy_wings" : !["disabled", "hidden"].includesAny(_angel.wings, _bird.wings),
					"fallenharpy_wings" : !["disabled", "hidden"].includesAny(_fallen.wings, _bird.wings),
				}>>
				<<set $_chimeraEnabled to Object.values($_chimeraOptions).some(o => o) ? "" : " hide">>
				<div @class="'chimera' + $_chimeraEnabled">
					<<if _divine>><<tficon _divine>><</if>>
					<span class="gold bold">Chimera</span>
					<<if $_chimeraOptions.demoncat_tail>>
						/* Using demon cat chimera tail. */
						<div class='tf-part-item'>
							Demon cat tail:
							<<listbox "$chimera.demoncat.tail" autoselect>>
								<<option "Show" true>>
								<<option "Hide" false>>
							<</listbox>>
						</div>
					<</if>>
					<<if $_chimeraOptions.demoncow_tail>>
						/* Using demon cow chimera tail. */
						<div class='tf-part-item'>
							Demon cow tail:
							<<listbox "$chimera.demoncow.tail" autoselect>>
								<<option "Show" true>>
								<<option "Hide" false>>
							<</listbox>>
						</div>
					<</if>>
					<<if $_chimeraOptions.demonwolf_tail>>
						/* Using demon wolf chimera tail. */
						<div class='tf-part-item'>
							Demon wolf tail:
							<<listbox "$chimera.demonwolf.tail" autoselect>>
								<<option "Show" true>>
								<<option "Hide" false>>
							<</listbox>>
						</div>
					<</if>>
					<<if $_chimeraOptions.demonfox_tail>>
						/* Using demon fox chimera tail. */
						<div class='tf-part-item'>
							Demon fox tail:
							<<listbox "$chimera.demonfox.tail" autoselect>>
								<<option "Show" true>>
								<<option "Hide" false>>
							<</listbox>>
						</div>
					<</if>>
					<<if $_chimeraOptions.demonfox_ears>>
						/* Using demon fox chimera ears. */
						<div class='tf-part-item'>
							Demon fox ears:
							<<listbox "$chimera.demonfox.ears" autoselect>>
								<<option "Show" true>>
								<<option "Hide" false>>
							<</listbox>>
						</div>
					<</if>>
					<<if $_chimeraOptions.demonharpy_wings>>
						/* Using demon harpy chimera wings. */
						<div class='tf-part-item'>
							Demon harpy wings:
							<<listbox "$chimera.demonharpy.wings" autoselect>>
								<<option "Show" true>>
								<<option "Hide" false>>
							<</listbox>>
						</div>
					<</if>>
					<<if $_chimeraOptions.angelharpy_wings>>
						/* Using angel harpy chimera wings. */
						<div class='tf-part-item'>
							Angel harpy wings:
							<<listbox "$chimera.angelharpy.wings" autoselect>>
								<<option "Show" true>>
								<<option "Hide" false>>
							<</listbox>>
						</div>
					<</if>>
					<<if $_chimeraOptions.fallenharpy_wings>>
						/* Using fallen angel harpy chimera wings. */
						<div class='tf-part-item'>
							Fallen harpy wings:
							<<listbox "$chimera.fallenharpy.wings" autoselect>>
								<<option "Show" true>>
								<<option "Hide" false>>
							<</listbox>>
						</div>
					<</if>>
				</div>
			</div>
		<</if>>
		<<if !["demon", "cow"].every(transform => T[transform].horns is "disabled") || !["demon", "cat", "cow", "wolf", "bird", "fox"].every(transform => T[transform].tail is "disabled") || !["angel", "fallen", "demon", "bird"].every(transform => T[transform].wings is "disabled")>>
			<div class="settingsToggleItemWide no-numberify">
				<span class="gold bold">Layer Adjustments:</span>
				<br>
				<<if !["demon", "cow"].every(transform => T[transform].horns is "disabled")>>
					<<switch $hornslayer>>
						<<case "front">>
							<<link "Prioritise headwear over horns">>
								<<run State.setVar("$hornslayer", "back")>>
								<<run Engine.show()>>
								<<updatesidebarimg true>>
							<</link>>
						<<case "back">>
							<<link "Prioritise horns over headwear">>
								<<run State.setVar("$hornslayer", "front")>>
								<<run Engine.show()>>
								<<updatesidebarimg true>>
							<</link>>
						<<default>>
							<<link "Prioritise horns over headwear">>
								<<run State.setVar("$hornslayer", "front")>>
								<<run Engine.show()>>
								<<updatesidebarimg true>>
							<</link>>
					<</switch>>
					<br>
				<</if>>
				<<if !["demon", "cat", "cow", "wolf", "bird", "fox"].every(transform => T[transform].tail is "disabled")>>
					<<switch $taillayer>>
						<<case "front">>
							<<link "Push tail back">>
								<<run State.setVar("$taillayer", "back")>>
								<<run Engine.show()>>
								<<updatesidebarimg true>>
							<</link>>
						<<case "back">>
							<<link "Move tail forward">>
								<<run State.setVar("$taillayer", "front")>>
								<<run Engine.show()>>
								<<updatesidebarimg true>>
							<</link>>
						<<default>>
							<<link "Push tail back">>
								<<run State.setVar("$taillayer", "back")>>
								<<run Engine.show()>>
								<<updatesidebarimg true>>
							<</link>>
					<</switch>>
					<br>
				<</if>>
				<<if !["angel", "fallen", "demon", "bird"].every(transform => T[transform].wings is "disabled")>>
					<<switch $wingslayer>>
						<<case "front">>
							<<link "Push wings behind">>
								<<run State.setVar("$wingslayer", "back")>>
								<<run Engine.show()>>
								<<updatesidebarimg true>>
							<</link>>
						<<case "back">>
							<<link "Move wings forward">>
								<<run State.setVar("$wingslayer", "front")>>
								<<run Engine.show()>>
								<<updatesidebarimg true>>
							<</link>>
						<<default>>
							<<link "Push wings behind">>
								<<run State.setVar("$wingslayer", "back")>>
								<<run Engine.show()>>
								<<updatesidebarimg true>>
							<</link>>
					<</switch>>
					<br>
				<</if>>
			</div>
		<</if>>
		<<if _isMenuEnabled>>
			<details class="expandMenu">
				<summary class="expandMenu">Custom Colours</summary>
				<div class="menuWarning">
					You haven't chosen any transformation parts! Select the checkboxes for the parts you'd like to recolour.
				</div>
				<div class="menuContent hidden">
					<<set _options to ['ffffff', 'ff0000', '00ff00', '0000ff', '590099', '000000']>>
					<<gencoloursquares _options>>
					<<gencolourpicker>>
				</div>
			</details>
		<</if>>
	</div>

	<!-- Attach an event to every listbox item to update the PC on the sidebar. -->
	<<script>>
		jQuery('.passage').on('change', 'select.macro-listbox', function (e) {
			if (V.transformationParts.cat.heterochromia === "hidden") {
				Wikifier.wikifyEval('<<catHeterochromiaTF "hide">>');
			} else if (V.cat >= 7 && V.cat <= 10) {
				Wikifier.wikifyEval('<<catHeterochromiaTF `$cat - 7`>>')
			};
			Wikifier.wikifyEval('<<updatesidebarimg true>>');
		});
	<</script>>
<</widget>>
